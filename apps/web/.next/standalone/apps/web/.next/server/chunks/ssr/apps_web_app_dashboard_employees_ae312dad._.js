module.exports=[77586,a=>{"use strict";var b=a.i(50586),c=a.i(92989),d=a.i(43578),e=a.i(41487),f=a.i(61644),g=a.i(88524),h=a.i(55404),i=a.i(95709),j=a.i(51959);let k=(0,j.createServerReference)("403436518ac5fdd91354ed91d48edcf3a3c5db3175",j.callServer,void 0,j.findSourceMapURL,"createEmployee"),l=(0,j.createServerReference)("6020af006a3b69df729950905fd13bb582e96bc819",j.callServer,void 0,j.findSourceMapURL,"updateEmployee"),m=(0,j.createServerReference)("4034854ccfb5932e3e079d755981213270ff1a89c6",j.callServer,void 0,j.findSourceMapURL,"uploadEmployeeImage"),n=(0,j.createServerReference)("40fb98609ed453fa86f0d09f3d89f9effabb985abc",j.callServer,void 0,j.findSourceMapURL,"deleteEmployeeImage");var o=a.i(10267),p=a.i(434),q=a.i(98416),r=a.i(49453),s=a.i(57751),t=a.i(2611);let u=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],v={monday:"Montag",tuesday:"Dienstag",wednesday:"Mittwoch",thursday:"Donnerstag",friday:"Freitag",saturday:"Samstag",sunday:"Sonntag"},w=[{value:"stylist",label:"Stylist/Kosmetiker"},{value:"receptionist",label:"Rezeption"},{value:"manager",label:"Manager"},{value:"other",label:"Sonstige"}];function x({employee:a,services:j}){let[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(a?.specialties||[]),[F,G]=(0,c.useState)(a?.profile_image_url||null),[H,I]=(0,c.useState)(a?.bio||""),J=(0,c.useRef)(null),[K,L]=(0,c.useState)(u.reduce((b,c)=>{let d=a?.work_schedule?.[c];return b[c]=d?{...d,enabled:!0}:{start:"09:00",end:"17:00",enabled:!1},b},{})),M=async a=>{let b=a.target.files?.[0];if(b){C(!0);try{let a=await (0,t.default)(b,{maxSizeMB:.5,maxWidthOrHeight:800,useWebWorker:!0});console.log("Original:",(b.size/1024).toFixed(0),"KB"),console.log("Komprimiert:",(a.size/1024).toFixed(0),"KB");let c=new FormData;c.append("file",a);let d=await m(c);d.error?alert("Fehler beim Hochladen: "+d.error):d.url&&(F&&await n(F),G(d.url))}catch(a){console.error("Compression error:",a),alert("Fehler bei der Bildverarbeitung")}C(!1)}},N=async()=>{F&&(await n(F),G(null))},O=async b=>{b.preventDefault(),A(!0);let c=new FormData(b.currentTarget);c.set("specialties",D.join(","));let d=Object.entries(K).reduce((a,[b,c])=>(c.enabled&&(a[b]={start:c.start,end:c.end}),a),{});c.set("work_schedule",JSON.stringify(d)),c.set("profile_image_url",F||""),c.set("bio",H);let e=a?await l(a.id,c):await k(c);A(!1),e.error?alert("Fehler: "+e.error):y(!1)};return(0,b.jsxs)(d.Dialog,{open:x,onOpenChange:y,children:[(0,b.jsx)(d.DialogTrigger,{asChild:!0,children:a?(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",children:"Bearbeiten"}):(0,b.jsxs)(e.Button,{children:[(0,b.jsx)(o.Plus,{className:"w-4 h-4 mr-2"}),"Mitarbeiter hinzufügen"]})}),(0,b.jsxs)(d.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)(d.DialogHeader,{children:(0,b.jsx)(d.DialogTitle,{children:a?"Mitarbeiter bearbeiten":"Neuer Mitarbeiter"})}),(0,b.jsxs)("form",{onSubmit:O,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Profilbild"}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,b.jsx)("div",{className:"relative",children:F?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:F,alt:"Profilbild",className:"w-24 h-24 rounded-full object-cover border-2 border-border"}),(0,b.jsx)("button",{type:"button",onClick:N,className:"absolute -top-2 -right-2 bg-destructive text-destructive-foreground rounded-full p-1 hover:bg-destructive/90",children:(0,b.jsx)(q.X,{className:"w-4 h-4"})})]}):(0,b.jsx)("div",{className:"w-24 h-24 rounded-full bg-muted flex items-center justify-center border-2 border-dashed border-border",children:(0,b.jsx)(r.User,{className:"w-8 h-8 text-muted-foreground"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("input",{ref:J,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:M,className:"hidden"}),(0,b.jsx)(e.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>J.current?.click(),disabled:B,children:B?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Hochladen..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Upload,{className:"w-4 h-4 mr-2"}),"Bild hochladen"]})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"JPEG, PNG, WebP oder GIF. Max 5MB."})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"first_name",children:"Vorname *"}),(0,b.jsx)(f.Input,{id:"first_name",name:"first_name",defaultValue:a?.first_name,required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"last_name",children:"Nachname *"}),(0,b.jsx)(f.Input,{id:"last_name",name:"last_name",defaultValue:a?.last_name,required:!0})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"email",children:"E-Mail"}),(0,b.jsx)(f.Input,{id:"email",name:"email",type:"email",defaultValue:a?.email||""})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"phone",children:"Telefon"}),(0,b.jsx)(f.Input,{id:"phone",name:"phone",type:"tel",defaultValue:a?.phone||""})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"role",children:"Rolle"}),(0,b.jsxs)(h.Select,{name:"role",defaultValue:a?.role||"stylist",children:[(0,b.jsx)(h.SelectTrigger,{children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsx)(h.SelectContent,{children:w.map(a=>(0,b.jsx)(h.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"bio",children:"Beschreibung / Bio"}),(0,b.jsx)("textarea",{id:"bio",value:H,onChange:a=>I(a.target.value),placeholder:"Kurze Beschreibung des Mitarbeiters für die Team-Seite...",className:"flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Wird auf der öffentlichen Team-Seite angezeigt"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Spezialisierungen (Services)"}),(0,b.jsx)("div",{className:"border rounded-lg p-3 space-y-2 max-h-40 overflow-y-auto",children:j.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:`service-${a.id}`,checked:D.includes(a.id),onCheckedChange:b=>{b?E([...D,a.id]):E(D.filter(b=>b!==a.id))}}),(0,b.jsx)("label",{htmlFor:`service-${a.id}`,className:"text-sm cursor-pointer",children:a.name})]},a.id))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"hourly_rate",children:"Stundensatz (€)"}),(0,b.jsx)(f.Input,{id:"hourly_rate",name:"hourly_rate",type:"number",step:"0.01",defaultValue:a?.hourly_rate||0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"commission_percentage",children:"Provision (%)"}),(0,b.jsx)(f.Input,{id:"commission_percentage",name:"commission_percentage",type:"number",step:"0.01",min:"0",max:"100",defaultValue:a?.commission_percentage||0})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Arbeitszeiten"}),(0,b.jsx)("div",{className:"border rounded-lg p-3 space-y-2",children:u.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(i.Checkbox,{id:`day-${a}`,checked:K[a].enabled,onCheckedChange:b=>{L({...K,[a]:{...K[a],enabled:!!b}})}}),(0,b.jsx)("label",{htmlFor:`day-${a}`,className:"w-24 text-sm",children:v[a]}),K[a].enabled&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Input,{type:"time",value:K[a].start,onChange:b=>{L({...K,[a]:{...K[a],start:b.target.value}})},className:"w-32"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"bis"}),(0,b.jsx)(f.Input,{type:"time",value:K[a].end,onChange:b=>{L({...K,[a]:{...K[a],end:b.target.value}})},className:"w-32"})]})]},a))})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:"is_active",name:"is_active",value:"true",defaultChecked:a?.is_active??!0}),(0,b.jsx)("label",{htmlFor:"is_active",className:"text-sm cursor-pointer",children:"Aktiv"})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Abbrechen"}),(0,b.jsx)(e.Button,{type:"submit",disabled:z||B,children:z?"Speichern...":"Speichern"})]})]})]})]})}a.s(["EmployeeDialog",()=>x],77586)},4536,a=>{"use strict";var b=a.i(50586),c=a.i(92989),d=a.i(32714),e=a.i(41487),f=a.i(99574),g=a.i(77586),h=a.i(51959);let i=(0,h.createServerReference)("40c664ac32d3e5bdf26b6e9a0eb615d306433dcb5f",h.callServer,void 0,h.findSourceMapURL,"deleteEmployee");var j=a.i(78189),k=a.i(57178),l=a.i(21798),m=a.i(2507),n=a.i(84285),o=a.i(49453);let p={stylist:"Stylist/Kosmetiker",receptionist:"Rezeption",manager:"Manager",other:"Sonstige"};function q({employees:a,services:h}){let[q,r]=(0,c.useState)(null),s=async(a,b)=>{if(!confirm(`M\xf6chten Sie ${b} wirklich l\xf6schen?`))return;r(a);let c=await i(a);r(null),c.error&&alert("Fehler: "+c.error)};return(0,b.jsx)("div",{className:"space-y-4",children:0===a.length?(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"py-12 text-center text-muted-foreground",children:(0,b.jsx)("p",{children:"Noch keine Mitarbeiter angelegt"})})}):(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(a=>{let c;return(0,b.jsxs)(d.Card,{className:a.is_active?"":"opacity-60",children:[(0,b.jsx)(d.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:a.profile_image_url?(0,b.jsx)("img",{src:a.profile_image_url,alt:`${a.first_name} ${a.last_name}`,className:"w-16 h-16 rounded-full object-cover border-2 border-border"}):(0,b.jsx)("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center border-2 border-border",children:(0,b.jsx)(o.User,{className:"w-8 h-8 text-muted-foreground"})})}),(0,b.jsx)("div",{className:"flex-1 min-w-0",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(d.CardTitle,{className:"text-lg",children:[a.first_name," ",a.last_name]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:p[a.role]||a.role})]}),!a.is_active&&(0,b.jsx)(f.Badge,{variant:"secondary",children:"Inaktiv"})]})})]})}),(0,b.jsxs)(d.CardContent,{className:"space-y-3",children:[a.email&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)(k.Mail,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"truncate",children:a.email})]}),a.phone&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)(j.Phone,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsx)("span",{children:a.phone})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)(l.Clock,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-xs",children:0===(c=Object.keys(a.work_schedule).length)?"Keine Arbeitszeiten":`${c} Tag${1!==c?"e":""}/Woche`})]}),a.commission_percentage>0&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)(m.TrendingUp,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsxs)("span",{className:"text-xs",children:[a.commission_percentage,"% Provision"]})]}),a.specialties.length>0&&(0,b.jsxs)("div",{className:"pt-2 border-t",children:[(0,b.jsx)("p",{className:"text-xs font-semibold mb-1",children:"Spezialisierungen:"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",children:a.specialties.map(a=>h.find(b=>b.id===a)?.name).filter(Boolean).join(", ")||"Keine"})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,b.jsx)(g.EmployeeDialog,{employee:a,services:h}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>s(a.id,`${a.first_name} ${a.last_name}`),disabled:q===a.id,children:(0,b.jsx)(n.Trash2,{className:"w-4 h-4"})})]})]})]},a.id)})})})}a.s(["EmployeesList",()=>q],4536)}];

//# sourceMappingURL=apps_web_app_dashboard_employees_ae312dad._.js.map