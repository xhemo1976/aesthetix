module.exports=[90926,a=>{"use strict";var b=a.i(50586),c=a.i(92989),d=a.i(32714),e=a.i(41487),f=a.i(64598),g=a.i(99574),h=a.i(75036),i=a.i(57178),j=a.i(78189),k=a.i(99756),l=a.i(41444),m=a.i(21798),n=a.i(49453),o=a.i(72873);let p=(0,o.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var q=a.i(40354),r=a.i(52461),s=a.i(65905),t=a.i(57651),u=a.i(10668),v=a.i(93094);let w=(0,o.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var x=a.i(51959);let y=(0,x.createServerReference)("701e6f343c3a139d8a96c97361c4a30c15bc2d25b9",x.callServer,void 0,x.findSourceMapURL,"updateCustomerNotes"),z=(0,x.createServerReference)("60000f278c7756b8a4b5c23d534c1552ce41a65fb2",x.callServer,void 0,x.findSourceMapURL,"updateAppointmentNotes");var A=a.i(17617);function B({customer:a,appointments:o,stats:x,clinicWhatsApp:B,clinicName:C}){let[D,E]=(0,c.useState)(a.notes||""),[F,G]=(0,c.useState)(a.medical_notes||""),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)({});async function P(){K(!0);let b=await y(a.id,D||null,F||null);K(!1),b.error||I(!1)}async function Q(a){let b=N[a]||"";await z(a,b||null),M(null)}function R(a){return new Date(a).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})}function S(a){return new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(a)}return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold",children:[a.first_name," ",a.last_name]}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Kunde seit ",R(a.created_at)]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[a.email&&(0,b.jsx)(e.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,b.jsxs)("a",{href:`mailto:${a.email}`,children:[(0,b.jsx)(i.Mail,{className:"w-4 h-4 mr-2"}),"E-Mail"]})}),a.phone&&(0,b.jsx)(e.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,b.jsxs)("a",{href:`tel:${a.phone}`,children:[(0,b.jsx)(j.Phone,{className:"w-4 h-4 mr-2"}),"Anrufen"]})}),B&&a.phone&&(0,b.jsx)(e.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,b.jsxs)("a",{href:(0,A.getCustomerContactLink)(a.phone,`${a.first_name} ${a.last_name}`,C),target:"_blank",rel:"noopener noreferrer",children:[(0,b.jsx)(r.MessageCircle,{className:"w-4 h-4 mr-2 text-green-600"}),"WhatsApp"]})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(k.Calendar,{className:"w-5 h-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:x?.totalAppointments||0}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Termine gesamt"})]})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,b.jsx)(s.CheckCircle,{className:"w-5 h-5 text-green-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:x?.completedAppointments||0}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Abgeschlossen"})]})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,b.jsx)(l.Euro,{className:"w-5 h-5 text-yellow-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:S(x?.totalSpent||0)}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Gesamtumsatz"})]})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-red-100 rounded-lg",children:(0,b.jsx)(t.XCircle,{className:"w-5 h-5 text-red-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:(x?.canceledAppointments||0)+(x?.noShowAppointments||0)}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Absagen/No-Shows"})]})]})})})]}),(0,b.jsxs)(h.Tabs,{defaultValue:"history",className:"w-full",children:[(0,b.jsxs)(h.TabsList,{className:"grid w-full grid-cols-3",children:[(0,b.jsx)(h.TabsTrigger,{value:"history",children:"Behandlungshistorie"}),(0,b.jsx)(h.TabsTrigger,{value:"notes",children:"Notizen"}),(0,b.jsx)(h.TabsTrigger,{value:"info",children:"Kontaktdaten"})]}),(0,b.jsx)(h.TabsContent,{value:"history",className:"mt-6",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Clock,{className:"w-5 h-5"}),"Behandlungshistorie"]})}),(0,b.jsx)(d.CardContent,{children:0===o.length?(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"Noch keine Termine vorhanden"}):(0,b.jsx)("div",{className:"space-y-4",children:o.map(a=>{let c=Array.isArray(a.services)?a.services[0]:a.services,d=Array.isArray(a.employees)?a.employees[0]:a.employees;return(0,b.jsx)("div",{className:"border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:c?.name||"Unbekannter Service"}),function(a){switch(a){case"completed":return(0,b.jsxs)(g.Badge,{className:"bg-green-100 text-green-800",children:[(0,b.jsx)(s.CheckCircle,{className:"w-3 h-3 mr-1"}),"Abgeschlossen"]});case"confirmed":return(0,b.jsxs)(g.Badge,{className:"bg-blue-100 text-blue-800",children:[(0,b.jsx)(s.CheckCircle,{className:"w-3 h-3 mr-1"}),"Bestätigt"]});case"scheduled":return(0,b.jsxs)(g.Badge,{className:"bg-yellow-100 text-yellow-800",children:[(0,b.jsx)(m.Clock,{className:"w-3 h-3 mr-1"}),"Geplant"]});case"canceled":return(0,b.jsxs)(g.Badge,{className:"bg-red-100 text-red-800",children:[(0,b.jsx)(t.XCircle,{className:"w-3 h-3 mr-1"}),"Storniert"]});case"no_show":return(0,b.jsxs)(g.Badge,{className:"bg-gray-100 text-gray-800",children:[(0,b.jsx)(u.AlertCircle,{className:"w-3 h-3 mr-1"}),"Nicht erschienen"]});default:return(0,b.jsx)(g.Badge,{variant:"secondary",children:a})}}(a.status)]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Calendar,{className:"w-3 h-3"}),new Date(a.start_time).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]}),d&&(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.User,{className:"w-3 h-3"}),d.first_name," ",d.last_name]}),(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Euro,{className:"w-3 h-3"}),S(a.price)]})]})]}),(0,b.jsxs)("div",{className:"flex-1 md:border-l md:pl-4",children:[L===a.id?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Textarea,{placeholder:"Behandlungsnotizen...",value:N[a.id]??a.staff_notes??"",onChange:b=>O({...N,[a.id]:b.target.value}),rows:3}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{size:"sm",onClick:()=>Q(a.id),children:[(0,b.jsx)(w,{className:"w-3 h-3 mr-1"}),"Speichern"]}),(0,b.jsx)(e.Button,{size:"sm",variant:"ghost",onClick:()=>M(null),children:"Abbrechen"})]})]}):(0,b.jsxs)("div",{children:[a.staff_notes?(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsxs)("p",{className:"font-medium mb-1 flex items-center gap-1",children:[(0,b.jsx)(p,{className:"w-3 h-3"}),"Behandlungsnotizen:"]}),(0,b.jsx)("p",{className:"text-muted-foreground whitespace-pre-wrap",children:a.staff_notes})]}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"Keine Behandlungsnotizen"}),(0,b.jsxs)(e.Button,{size:"sm",variant:"ghost",className:"mt-2",onClick:()=>{O({...N,[a.id]:a.staff_notes||""}),M(a.id)},children:[(0,b.jsx)(v.Edit,{className:"w-3 h-3 mr-1"}),a.staff_notes?"Bearbeiten":"Notiz hinzufügen"]})]}),a.customer_notes&&(0,b.jsxs)("div",{className:"mt-3 pt-3 border-t text-sm",children:[(0,b.jsx)("p",{className:"font-medium mb-1",children:"Kundenanmerkung:"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:a.customer_notes})]})]})]})},a.id)})})})]})}),(0,b.jsxs)(h.TabsContent,{value:"notes",className:"mt-6",children:[(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(p,{className:"w-5 h-5"}),"Allgemeine Notizen"]})}),(0,b.jsx)(d.CardContent,{children:H?(0,b.jsx)(f.Textarea,{placeholder:"Allgemeine Notizen zum Kunden...",value:D,onChange:a=>E(a.target.value),rows:6}):(0,b.jsx)("div",{className:"min-h-[150px]",children:D?(0,b.jsx)("p",{className:"whitespace-pre-wrap",children:D}):(0,b.jsx)("p",{className:"text-muted-foreground italic",children:"Keine Notizen vorhanden"})})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(q.Heart,{className:"w-5 h-5 text-red-500"}),"Medizinische Notizen"]})}),(0,b.jsx)(d.CardContent,{children:H?(0,b.jsx)(f.Textarea,{placeholder:"Allergien, Unverträglichkeiten, besondere Hinweise...",value:F,onChange:a=>G(a.target.value),rows:6}):(0,b.jsx)("div",{className:"min-h-[150px]",children:F?(0,b.jsx)("p",{className:"whitespace-pre-wrap",children:F}):(0,b.jsx)("p",{className:"text-muted-foreground italic",children:"Keine medizinischen Notizen"})})})]})]}),(0,b.jsx)("div",{className:"flex justify-end mt-4",children:H?(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{E(a.notes||""),G(a.medical_notes||""),I(!1)},children:"Abbrechen"}),(0,b.jsxs)(e.Button,{onClick:P,disabled:J,children:[(0,b.jsx)(w,{className:"w-4 h-4 mr-2"}),J?"Speichert...":"Speichern"]})]}):(0,b.jsxs)(e.Button,{onClick:()=>I(!0),children:[(0,b.jsx)(v.Edit,{className:"w-4 h-4 mr-2"}),"Notizen bearbeiten"]})})]}),(0,b.jsx)(h.TabsContent,{value:"info",className:"mt-6",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(n.User,{className:"w-5 h-5"}),"Kontaktdaten"]})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"E-Mail"}),(0,b.jsx)("p",{className:"font-medium",children:a.email||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Telefon"}),(0,b.jsx)("p",{className:"font-medium",children:a.phone||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Geburtsdatum"}),(0,b.jsx)("p",{className:"font-medium",children:a.date_of_birth?R(a.date_of_birth):"-"})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Adresse"}),(0,b.jsxs)("p",{className:"font-medium",children:[a.address||"-",a.address&&(a.postal_code||a.city)&&(0,b.jsx)("br",{}),a.postal_code," ",a.city]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Marketing-Einwilligung"}),(0,b.jsx)("p",{className:"font-medium",children:a.marketing_consent?(0,b.jsxs)("span",{className:"text-green-600 flex items-center gap-1",children:[(0,b.jsx)(s.CheckCircle,{className:"w-4 h-4"})," Ja"]}):(0,b.jsxs)("span",{className:"text-red-600 flex items-center gap-1",children:[(0,b.jsx)(t.XCircle,{className:"w-4 h-4"})," Nein"]})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"SMS/WhatsApp-Einwilligung"}),(0,b.jsx)("p",{className:"font-medium",children:a.sms_consent?(0,b.jsxs)("span",{className:"text-green-600 flex items-center gap-1",children:[(0,b.jsx)(s.CheckCircle,{className:"w-4 h-4"})," Ja"]}):(0,b.jsxs)("span",{className:"text-red-600 flex items-center gap-1",children:[(0,b.jsx)(t.XCircle,{className:"w-4 h-4"})," Nein"]})})]})]})]})})]})})]})]})}a.s(["CustomerDetail",()=>B],90926)}];

//# sourceMappingURL=apps_web_app_dashboard_customers_%5Bid%5D_customer-detail_tsx_0df77753._.js.map