module.exports=[66680,(a,b,c)=>{b.exports=a.x("node:crypto",()=>require("node:crypto"))},93452,a=>{"use strict";var b=a.i(38735),c=a.i(80159),d=a.i(56511),e=a.i(66680);let f={randomUUID:e.randomUUID},g=new Uint8Array(256),h=g.length,i=[];for(let a=0;a<256;++a)i.push((a+256).toString(16).slice(1));let j=function(a,b,c){if(f.randomUUID&&!b&&!a)return f.randomUUID();var d=a,j=c;let k=(d=d||{}).random??d.rng?.()??(h>g.length-16&&((0,e.randomFillSync)(g),h=0),g.slice(h,h+=16));if(k.length<16)throw Error("Random bytes length must be >= 16");if(k[6]=15&k[6]|64,k[8]=63&k[8]|128,b){if((j=j||0)<0||j+16>b.length)throw RangeError(`UUID byte range ${j}:${j+15} is out of buffer bounds`);for(let a=0;a<16;++a)b[j+a]=k[a];return b}return function(a,b=0){return(i[a[b+0]]+i[a[b+1]]+i[a[b+2]]+i[a[b+3]]+"-"+i[a[b+4]]+i[a[b+5]]+"-"+i[a[b+6]]+i[a[b+7]]+"-"+i[a[b+8]]+i[a[b+9]]+"-"+i[a[b+10]]+i[a[b+11]]+i[a[b+12]]+i[a[b+13]]+i[a[b+14]]+i[a[b+15]]).toLowerCase()}(k)};async function k(){let a=await (0,c.createClient)(),{data:{user:b}}=await a.auth.getUser();if(!b)return{employees:null,error:"Not authenticated"};let{data:d}=await a.from("users").select("tenant_id").eq("id",b.id).single();if(!d?.tenant_id)return{employees:null,error:"No tenant found"};let{data:e,error:f}=await a.from("employees").select("*").eq("tenant_id",d.tenant_id).order("first_name",{ascending:!0});return f?(console.error("Error fetching employees:",f),{employees:null,error:f.message}):{employees:e,error:null}}async function l(){let a=await (0,c.createClient)(),{data:{user:b}}=await a.auth.getUser();if(!b)return{employees:null,error:"Not authenticated"};let{data:d}=await a.from("users").select("tenant_id").eq("id",b.id).single();if(!d?.tenant_id)return{employees:null,error:"No tenant found"};let{data:e,error:f}=await a.from("employees").select("*").eq("tenant_id",d.tenant_id).eq("is_active",!0).order("first_name",{ascending:!0});return f?(console.error("Error fetching active employees:",f),{employees:null,error:f.message}):{employees:e,error:null}}async function m(a){let b=await (0,c.createClient)(),{data:{user:e}}=await b.auth.getUser();if(!e)return{error:"Not authenticated"};let{data:f}=await b.from("users").select("tenant_id").eq("id",e.id).single();if(!f?.tenant_id)return{error:"No tenant found"};let g=a.get("specialties"),h=g?g.split(",").filter(a=>a.trim()):[],i=a.get("work_schedule"),j=i?JSON.parse(i):{},{error:k}=await b.from("employees").insert({tenant_id:f.tenant_id,first_name:a.get("first_name"),last_name:a.get("last_name"),email:a.get("email")||null,phone:a.get("phone")||null,role:a.get("role")||"stylist",specialties:h,hourly_rate:parseFloat(a.get("hourly_rate")||"0"),commission_percentage:parseFloat(a.get("commission_percentage")||"0"),work_schedule:j,is_active:"true"===a.get("is_active"),profile_image_url:a.get("profile_image_url")||null,bio:a.get("bio")||null});return k?(console.error("Error creating employee:",k),{error:k.message}):((0,d.revalidatePath)("/dashboard/employees"),{error:null})}async function n(a,b){let e=await (0,c.createClient)(),{data:{user:f}}=await e.auth.getUser();if(!f)return{error:"Not authenticated"};let g=b.get("specialties"),h=g?g.split(",").filter(a=>a.trim()):[],i=b.get("work_schedule"),j=i?JSON.parse(i):{},{error:k}=await e.from("employees").update({first_name:b.get("first_name"),last_name:b.get("last_name"),email:b.get("email")||null,phone:b.get("phone")||null,role:b.get("role")||"stylist",specialties:h,hourly_rate:parseFloat(b.get("hourly_rate")||"0"),commission_percentage:parseFloat(b.get("commission_percentage")||"0"),work_schedule:j,is_active:"true"===b.get("is_active"),profile_image_url:b.get("profile_image_url")||null,bio:b.get("bio")||null}).eq("id",a);return k?(console.error("Error updating employee:",k),{error:k.message}):((0,d.revalidatePath)("/dashboard/employees"),{error:null})}async function o(a){let b=await (0,c.createClient)(),{data:{user:e}}=await b.auth.getUser();if(!e)return{error:"Not authenticated"};let{error:f}=await b.from("employees").delete().eq("id",a);return f?(console.error("Error deleting employee:",f),{error:f.message}):((0,d.revalidatePath)("/dashboard/employees"),{error:null})}async function p(a,b,d){let e=await (0,c.createClient)(),{data:{user:f}}=await e.auth.getUser();if(!f)return{stats:null,error:"Not authenticated"};let{data:g}=await e.from("users").select("tenant_id").eq("id",f.id).single();if(!g?.tenant_id)return{stats:null,error:"No tenant found"};let h=e.from("appointments").select("*").eq("tenant_id",g.tenant_id).eq("employee_id",a);b&&(h=h.gte("start_time",b.toISOString())),d&&(h=h.lte("start_time",d.toISOString()));let{data:i,error:j}=await h;return j?(console.error("Error fetching employee stats:",j),{stats:null,error:j.message}):{stats:{total_appointments:i?.length||0,completed_appointments:i?.filter(a=>"completed"===a.status).length||0,cancelled_appointments:i?.filter(a=>"cancelled"===a.status).length||0,no_shows:i?.filter(a=>"no_show"===a.status).length||0,total_revenue:i?.filter(a=>"completed"===a.status).reduce((a,b)=>a+(b.price||0),0)||0},error:null}}async function q(a){let b=await (0,c.createClient)(),{data:{user:d}}=await b.auth.getUser();if(!d)return{url:null,error:"Not authenticated"};let{data:e}=await b.from("users").select("tenant_id").eq("id",d.id).single();if(!e?.tenant_id)return{url:null,error:"No tenant found"};let f=a.get("file");if(!f)return{url:null,error:"No file provided"};if(!["image/jpeg","image/png","image/webp","image/gif"].includes(f.type))return{url:null,error:"Invalid file type. Only JPEG, PNG, WebP and GIF are allowed."};if(f.size>5242880)return{url:null,error:"File too large. Maximum size is 5MB."};let g=f.name.split(".").pop(),h=`${e.tenant_id}/${j()}.${g}`,{error:i}=await b.storage.from("employee-images").upload(h,f,{cacheControl:"3600",upsert:!1});if(i)return console.error("Error uploading image:",i),{url:null,error:i.message};let{data:{publicUrl:k}}=b.storage.from("employee-images").getPublicUrl(h);return{url:k,error:null}}async function r(a){let b=await (0,c.createClient)(),{data:{user:d}}=await b.auth.getUser();if(!d)return{error:"Not authenticated"};let e=a.split("/employee-images/");if(e.length<2)return{error:"Invalid image URL"};let f=e[1],{error:g}=await b.storage.from("employee-images").remove([f]);return g?(console.error("Error deleting image:",g),{error:g.message}):{error:null}}(0,a.i(98246).ensureServerEntryExports)([k,l,m,n,o,p,q,r]),(0,b.registerServerReference)(k,"0093e37328b590a65f8d37e8ce9fa05c903d1afef9",null),(0,b.registerServerReference)(l,"00bca40b9c27440715c941e69fbf2f341e7b2dda70",null),(0,b.registerServerReference)(m,"403436518ac5fdd91354ed91d48edcf3a3c5db3175",null),(0,b.registerServerReference)(n,"6020af006a3b69df729950905fd13bb582e96bc819",null),(0,b.registerServerReference)(o,"40c664ac32d3e5bdf26b6e9a0eb615d306433dcb5f",null),(0,b.registerServerReference)(p,"70fbf593b00f45ddaaf89fb3bd6e42222afbc2a28e",null),(0,b.registerServerReference)(q,"4034854ccfb5932e3e079d755981213270ff1a89c6",null),(0,b.registerServerReference)(r,"40fb98609ed453fa86f0d09f3d89f9effabb985abc",null),a.s(["createEmployee",()=>m,"deleteEmployee",()=>o,"deleteEmployeeImage",()=>r,"getActiveEmployees",()=>l,"getEmployeeStats",()=>p,"getEmployees",()=>k,"updateEmployee",()=>n,"uploadEmployeeImage",()=>q],93452)},71118,a=>{"use strict";var b=a.i(38735),c=a.i(56511),d=a.i(80159),e=a.i(81182);async function f(){let a=await (0,d.createClient)(),{data:b,error:c}=await a.from("services").select("*").order("created_at",{ascending:!1});return c?(console.error("Error fetching services:",c),{services:[],error:c.message}):{services:b,error:null}}async function g(a){let b=await (0,d.createClient)(),c=a.name.split(".").pop(),e=`${Date.now()}-${Math.random().toString(36).substring(7)}.${c}`,f=`dishes/${e}`,g=new Uint8Array(await a.arrayBuffer()),{error:h}=await b.storage.from("dish-images").upload(f,g,{contentType:a.type,cacheControl:"3600"});if(h)return console.error("Error uploading image:",h),{url:null,error:h.message};let{data:{publicUrl:i}}=b.storage.from("dish-images").getPublicUrl(f);return{url:i,error:null}}async function h(a){let b=await (0,d.createClient)(),f=(0,e.createAdminClient)(),{data:{user:g}}=await b.auth.getUser();if(!g)return{error:"Nicht authentifiziert"};let{data:h}=await f.from("users").select("tenant_id").eq("id",g.id).single();if(!h)return{error:"Profil nicht gefunden"};let i=a.get("name"),j=a.get("description"),k=a.get("category"),l=parseFloat(a.get("price")),m=parseInt(a.get("duration_minutes")),n=a.get("image_url")||null,o=a.get("category_image_url")||null,p=a.get("allergens"),q=p?JSON.parse(p):[],r=a.get("diet_labels");r&&JSON.parse(r);let s=a.get("other_labels");s&&JSON.parse(s);let t=a.get("cross_contamination");t&&JSON.parse(t);let u="true"===a.get("is_vegetarian"),v="true"===a.get("is_vegan"),w="true"===a.get("is_spicy"),{error:x}=await b.from("services").insert({tenant_id:h.tenant_id,name:i,description:j,category:k,category_image_url:o||null,price:l,duration_minutes:m,is_active:!0,image_url:n||null,allergens:q.length>0?q:null,is_vegetarian:u,is_vegan:v,is_spicy:w});return x?(console.error("Error creating service:",x),{error:x.message}):(k&&o&&await b.from("services").update({category_image_url:o}).eq("tenant_id",h.tenant_id).eq("category",k),(0,c.revalidatePath)("/dashboard/services"),{error:null})}async function i(a,b){let e=await (0,d.createClient)(),f=b.get("name"),g=b.get("description"),h=b.get("category"),i=parseFloat(b.get("price")),j=parseInt(b.get("duration_minutes")),k=b.get("image_url")||null,l=b.get("category_image_url")||null,m=b.get("allergens"),n=m?JSON.parse(m):[],o="true"===b.get("is_vegetarian"),p="true"===b.get("is_vegan"),q="true"===b.get("is_spicy"),{error:r}=await e.from("services").update({name:f,description:g,category:h,category_image_url:l||null,price:i,duration_minutes:j,image_url:k||null,allergens:n.length>0?n:null,is_vegetarian:o,is_vegan:p,is_spicy:q}).eq("id",a);if(r)return console.error("Error updating service:",r),{error:r.message};if(h&&l){let{data:b}=await e.from("services").select("tenant_id").eq("id",a).single();b&&await e.from("services").update({category_image_url:l}).eq("tenant_id",b.tenant_id).eq("category",h)}return(0,c.revalidatePath)("/dashboard/services"),{error:null}}async function j(a){let b=await (0,d.createClient)(),{error:e}=await b.from("services").delete().eq("id",a);return e?(console.error("Error deleting service:",e),{error:e.message}):((0,c.revalidatePath)("/dashboard/services"),{error:null})}async function k(a,b){let e=await (0,d.createClient)(),{error:f}=await e.from("services").update({is_active:!b}).eq("id",a);return f?(console.error("Error toggling service status:",f),{error:f.message}):((0,c.revalidatePath)("/dashboard/services"),{error:null})}async function l(){let a=await (0,d.createClient)(),{data:b,error:c}=await a.from("services").select("name, description, category, price, duration_minutes, is_active, image_url, category_image_url, allergens, diet_labels, other_labels, cross_contamination, is_vegetarian, is_vegan, is_spicy").order("category",{ascending:!0}).order("name",{ascending:!0});return c?(console.error("Error exporting services:",c),{services:[],error:c.message}):{services:b,error:null}}async function m(a){let b=await (0,d.createClient)(),f=(0,e.createAdminClient)(),{data:{user:g}}=await b.auth.getUser();if(!g)return{error:"Nicht authentifiziert",imported:0};let{data:h}=await f.from("users").select("tenant_id").eq("id",g.id).single();if(!h)return{error:"Profil nicht gefunden",imported:0};let i=0,j=[];for(let c of a){if(!c.name||void 0===c.price||void 0===c.duration_minutes){j.push(`\xdcbersprungen: "${c.name||"Unbenannt"}" - Name, Preis oder Dauer fehlt`);continue}let{error:a}=await b.from("services").insert({tenant_id:h.tenant_id,name:c.name,description:c.description||null,category:c.category||null,price:c.price,duration_minutes:c.duration_minutes,is_active:!1!==c.is_active,image_url:c.image_url||null,category_image_url:c.category_image_url||null,allergens:c.allergens?.length?c.allergens:null,diet_labels:c.diet_labels?.length?c.diet_labels:null,other_labels:c.other_labels?.length?c.other_labels:null,cross_contamination:c.cross_contamination?.length?c.cross_contamination:null,is_vegetarian:c.is_vegetarian||!1,is_vegan:c.is_vegan||!1,is_spicy:c.is_spicy||!1});a?j.push(`Fehler bei "${c.name}": ${a.message}`):i++}return(0,c.revalidatePath)("/dashboard/services"),{error:j.length>0?j.join("\n"):null,imported:i,total:a.length}}(0,a.i(98246).ensureServerEntryExports)([f,g,h,i,j,k,l,m]),(0,b.registerServerReference)(f,"005d4a16cc3f1c9d6de42a96aa62f2bab538afa94b",null),(0,b.registerServerReference)(g,"4031f14c1707f0e37da0005df8fa8ab36c1a3f5935",null),(0,b.registerServerReference)(h,"402cd21ffb7a3c56b09af06fb4c5043b38c5a55190",null),(0,b.registerServerReference)(i,"608de8ff0a4bdc697186ecb3f9f725e339083da387",null),(0,b.registerServerReference)(j,"4072eae6cf452ff8a263c5ef9e89fb633185d5b94d",null),(0,b.registerServerReference)(k,"60e0e2c66009f6838a672eccb9b91822df45af2e93",null),(0,b.registerServerReference)(l,"0042a2abe349a413d4622436da0130103736329c4f",null),(0,b.registerServerReference)(m,"40a31f38d9ffa3be3e030d3686f3cc427ead83e6d7",null),a.s(["createService",()=>h,"deleteService",()=>j,"exportServices",()=>l,"getServices",()=>f,"importServices",()=>m,"toggleServiceStatus",()=>k,"updateService",()=>i,"uploadServiceImage",()=>g])},81032,a=>{"use strict";var b=a.i(38735),c=a.i(56511),d=a.i(80159),e=a.i(81182);async function f(){let a=await (0,d.createClient)(),{data:b,error:c}=await a.from("customers").select("*").order("created_at",{ascending:!1});return c?(console.error("Error fetching customers:",c),{customers:[],error:c.message}):{customers:b,error:null}}async function g(a){let b=await (0,d.createClient)(),f=(0,e.createAdminClient)(),{data:{user:g}}=await b.auth.getUser();if(!g)return{error:"Nicht authentifiziert"};let{data:h}=await f.from("users").select("tenant_id").eq("id",g.id).single();if(!h)return{error:"Profil nicht gefunden"};let i=a.get("first_name"),j=a.get("last_name"),k=a.get("email"),l=a.get("phone"),m=a.get("date_of_birth"),n=a.get("notes"),{error:o}=await b.from("customers").insert({tenant_id:h.tenant_id,first_name:i,last_name:j,email:k||null,phone:l||null,date_of_birth:m||null,notes:n||null});return o?(console.error("Error creating customer:",o),{error:o.message}):((0,c.revalidatePath)("/dashboard/customers"),{error:null})}async function h(a,b){let e=await (0,d.createClient)(),f=b.get("first_name"),g=b.get("last_name"),h=b.get("email"),i=b.get("phone"),j=b.get("date_of_birth"),k=b.get("notes"),{error:l}=await e.from("customers").update({first_name:f,last_name:g,email:h||null,phone:i||null,date_of_birth:j||null,notes:k||null}).eq("id",a);return l?(console.error("Error updating customer:",l),{error:l.message}):((0,c.revalidatePath)("/dashboard/customers"),{error:null})}async function i(a){let b=await (0,d.createClient)(),{error:e}=await b.from("customers").delete().eq("id",a);return e?(console.error("Error deleting customer:",e),{error:e.message}):((0,c.revalidatePath)("/dashboard/customers"),{error:null})}async function j(a){let b=await (0,d.createClient)(),{data:c,error:e}=await b.from("customers").select("*").eq("id",a).single();return e?(console.error("Error fetching customer:",e),{customer:null,error:e.message}):{customer:c,error:null}}async function k(a){let b=await (0,d.createClient)(),{data:c,error:e}=await b.from("appointments").select(`
      id,
      start_time,
      end_time,
      status,
      price,
      customer_notes,
      staff_notes,
      services (
        id,
        name,
        duration_minutes
      ),
      employees (
        id,
        first_name,
        last_name
      )
    `).eq("customer_id",a).order("start_time",{ascending:!1});return e?(console.error("Error fetching customer appointments:",e),{appointments:[],error:e.message}):{appointments:c||[],error:null}}async function l(a){let b=await (0,d.createClient)(),{data:c,error:e}=await b.from("appointments").select("status, price").eq("customer_id",a);if(e)return console.error("Error fetching customer stats:",e),{stats:null,error:e.message};let f=c?.filter(a=>"completed"===a.status)||[],g=c?.length||0,h=f.reduce((a,b)=>a+(b.price||0),0),i=c?.filter(a=>"canceled"===a.status).length||0,j=c?.filter(a=>"no_show"===a.status).length||0;return{stats:{totalAppointments:g,completedAppointments:f.length,canceledAppointments:i,noShowAppointments:j,totalSpent:h},error:null}}async function m(a,b,e){let f=await (0,d.createClient)(),{error:g}=await f.from("customers").update({notes:b,medical_notes:e}).eq("id",a);return g?(console.error("Error updating customer notes:",g),{error:g.message}):((0,c.revalidatePath)(`/dashboard/customers/${a}`),{error:null})}async function n(a,b){let e=await (0,d.createClient)(),{error:f}=await e.from("appointments").update({staff_notes:b}).eq("id",a);return f?(console.error("Error updating appointment notes:",f),{error:f.message}):((0,c.revalidatePath)("/dashboard/customers"),{error:null})}(0,a.i(98246).ensureServerEntryExports)([f,g,h,i,j,k,l,m,n]),(0,b.registerServerReference)(f,"0012f034365b466b68faf986a4afe957bff0eb83a1",null),(0,b.registerServerReference)(g,"400d346cab7161c17ec93d5519b52beca6ecac9269",null),(0,b.registerServerReference)(h,"60cdf908f1b0690e1642847a4cb020fde78f95ad2f",null),(0,b.registerServerReference)(i,"40c79fe125d7170d0b436107d1bde5b3b4e18b25be",null),(0,b.registerServerReference)(j,"4099f22a0b2ee55dee09b996db562a5dc53e70d768",null),(0,b.registerServerReference)(k,"402d4e400989e2c0d06ef868649fd9b933ed170464",null),(0,b.registerServerReference)(l,"40bbaf84ed7728bb863828c5d4c38a963fa07777c9",null),(0,b.registerServerReference)(m,"701e6f343c3a139d8a96c97361c4a30c15bc2d25b9",null),(0,b.registerServerReference)(n,"60000f278c7756b8a4b5c23d534c1552ce41a65fb2",null),a.s(["createCustomer",()=>g,"deleteCustomer",()=>i,"getCustomerAppointments",()=>k,"getCustomerById",()=>j,"getCustomerStats",()=>l,"getCustomers",()=>f,"updateAppointmentNotes",()=>n,"updateCustomer",()=>h,"updateCustomerNotes",()=>m])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__3de467de._.js.map