module.exports=[41893,a=>{"use strict";var b=a.i(50586),c=a.i(92989),d=a.i(41487),e=a.i(32714),f=a.i(99574),g=a.i(75036),h=a.i(43578),i=a.i(61644),j=a.i(88524),k=a.i(64598),l=a.i(55404),m=a.i(10267),n=a.i(21798),o=a.i(99756),p=a.i(49453),q=a.i(52461),r=a.i(84285),s=a.i(65905),t=a.i(57651),u=a.i(48530),v=a.i(10668),w=a.i(51959);let x=(0,w.createServerReference)("40459a667babdea845a7b9c41877fa4d7bb220e7cc",w.callServer,void 0,w.findSourceMapURL,"addToWaitlist"),y=(0,w.createServerReference)("605b34cbe125981b9dc140e20e7debf77f5cd0f0a1",w.callServer,void 0,w.findSourceMapURL,"updateWaitlistStatus"),z=(0,w.createServerReference)("40785ea3e95e0c80b7932a6bb3c9395bdbb4e5da10",w.callServer,void 0,w.findSourceMapURL,"deleteWaitlistEntry"),A=(0,w.createServerReference)("78c14a82da1c94ebb00627c84372bc25ec8b0f1a0d",w.callServer,void 0,w.findSourceMapURL,"getWaitlistNotificationLink");function B({initialEntries:a,services:w,customers:B,employees:C,tenantSlug:D,clinicName:E}){let[F,G]=(0,c.useState)(a),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)(""),[X,Y]=(0,c.useState)(""),[Z,$]=(0,c.useState)(""),[_,aa]=(0,c.useState)(""),[ab,ac]=(0,c.useState)(""),[ad,ae]=(0,c.useState)(""),[af,ag]=(0,c.useState)(""),[ah,ai]=(0,c.useState)(""),[aj,ak]=(0,c.useState)(""),[al,am]=(0,c.useState)(""),[an,ao]=(0,c.useState)("0"),ap=F.filter(a=>"waiting"===a.status),aq=F.filter(a=>"notified"===a.status),ar=F.filter(a=>["booked","expired","canceled"].includes(a.status));async function as(a){a.preventDefault(),S(!0);let b=new FormData;b.set("service_id",_),b.set("employee_id",ab||""),b.set("customer_id",T||""),b.set("customer_name",V),b.set("customer_email",X),b.set("customer_phone",Z),b.set("preferred_date_from",ad),b.set("preferred_date_to",af),b.set("preferred_time_from",ah),b.set("preferred_time_to",aj),b.set("notes",al),b.set("priority",an);let c=await x(b);c.error?alert(c.error):(I(!1),U(""),W(""),Y(""),$(""),aa(""),ac(""),ae(""),ag(""),ai(""),ak(""),am(""),ao("0"),window.location.reload()),S(!1)}async function at(a){!confirm("Möchtest du diesen Eintrag wirklich löschen?")||(await z(a)).error||G(F.filter(b=>b.id!==a))}async function au(a){(await y(a,"booked")).error||G(F.map(b=>b.id===a?{...b,status:"booked"}:b))}async function av(a){(await y(a,"canceled")).error||G(F.map(b=>b.id===a?{...b,status:"canceled"}:b))}async function aw(a){M(a),O(""),Q(""),K(!0)}async function ax(){if(!L||!N||!P)return;S(!0);let a=new Date(N).toLocaleDateString("de-DE",{weekday:"long",day:"numeric",month:"long"}),b=`${window.location.origin}/book/${D}`,c=await A(L.id,{date:a,time:P},E,b);c.link?(window.open(c.link,"_blank"),G(F.map(a=>a.id===L.id?{...a,status:"notified",notified_at:new Date().toISOString()}:a)),K(!1)):alert(c.error||"Fehler beim Erstellen des Links"),S(!1)}function ay(a){return new Date(a).toLocaleDateString("de-DE")}function az(a){return new Date(a).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}function aA(a){let c=Array.isArray(a.services)?a.services[0]:a.services,e=Array.isArray(a.employees)?a.employees[0]:a.employees;return(0,b.jsx)("div",{className:"border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.customer_name}),function(a){switch(a){case"waiting":return(0,b.jsxs)(f.Badge,{className:"bg-yellow-100 text-yellow-800",children:[(0,b.jsx)(n.Clock,{className:"w-3 h-3 mr-1"}),"Wartend"]});case"notified":return(0,b.jsxs)(f.Badge,{className:"bg-blue-100 text-blue-800",children:[(0,b.jsx)(u.Bell,{className:"w-3 h-3 mr-1"}),"Benachrichtigt"]});case"booked":return(0,b.jsxs)(f.Badge,{className:"bg-green-100 text-green-800",children:[(0,b.jsx)(s.CheckCircle,{className:"w-3 h-3 mr-1"}),"Gebucht"]});case"expired":return(0,b.jsxs)(f.Badge,{className:"bg-gray-100 text-gray-800",children:[(0,b.jsx)(v.AlertCircle,{className:"w-3 h-3 mr-1"}),"Abgelaufen"]});case"canceled":return(0,b.jsxs)(f.Badge,{className:"bg-red-100 text-red-800",children:[(0,b.jsx)(t.XCircle,{className:"w-3 h-3 mr-1"}),"Storniert"]});default:return(0,b.jsx)(f.Badge,{variant:"secondary",children:a})}}(a.status),a.priority>0&&(0,b.jsxs)(f.Badge,{variant:"outline",className:"text-xs",children:["Priorität: ",a.priority]})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(o.Calendar,{className:"w-3 h-3"}),"Zeitraum: ",ay(a.preferred_date_from)," - ",ay(a.preferred_date_to)]}),(a.preferred_time_from||a.preferred_time_to)&&(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Clock,{className:"w-3 h-3"}),"Zeit: ",a.preferred_time_from||"00:00"," - ",a.preferred_time_to||"23:59"]}),(0,b.jsxs)("p",{children:["Service: ",(0,b.jsx)("span",{className:"font-medium",children:c?.name||"Unbekannt"})]}),e&&(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(p.User,{className:"w-3 h-3"}),"Bevorzugt: ",e.first_name," ",e.last_name]}),a.customer_email&&(0,b.jsxs)("p",{children:["E-Mail: ",a.customer_email]}),a.customer_phone&&(0,b.jsxs)("p",{children:["Tel: ",a.customer_phone]}),a.notes&&(0,b.jsxs)("p",{className:"mt-2 italic",children:['"',a.notes,'"']})]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Eingetragen am ",az(a.created_at),a.notified_at&&(0,b.jsxs)("span",{children:[" | Benachrichtigt am ",az(a.notified_at)]})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:["waiting"===a.status&&a.customer_phone&&(0,b.jsxs)(d.Button,{size:"sm",variant:"default",onClick:()=>aw(a),children:[(0,b.jsx)(q.MessageCircle,{className:"w-4 h-4 mr-1"}),"Benachrichtigen"]}),"notified"===a.status&&(0,b.jsxs)(d.Button,{size:"sm",variant:"default",onClick:()=>au(a.id),children:[(0,b.jsx)(s.CheckCircle,{className:"w-4 h-4 mr-1"}),"Als gebucht markieren"]}),["waiting","notified"].includes(a.status)&&(0,b.jsxs)(d.Button,{size:"sm",variant:"outline",onClick:()=>av(a.id),children:[(0,b.jsx)(t.XCircle,{className:"w-4 h-4 mr-1"}),"Abbrechen"]}),(0,b.jsx)(d.Button,{size:"sm",variant:"ghost",onClick:()=>at(a.id),children:(0,b.jsx)(r.Trash2,{className:"w-4 h-4 text-destructive"})})]})]})},a.id)}return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,b.jsx)(n.Clock,{className:"w-5 h-5 text-yellow-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:ap.length}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Wartend"})]})]})})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,b.jsx)(u.Bell,{className:"w-5 h-5 text-blue-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:aq.length}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Benachrichtigt"})]})]})})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,b.jsx)(s.CheckCircle,{className:"w-5 h-5 text-green-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:ar.filter(a=>"booked"===a.status).length}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Gebucht"})]})]})})})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(h.Dialog,{open:H,onOpenChange:I,children:[(0,b.jsx)(h.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(d.Button,{children:[(0,b.jsx)(m.Plus,{className:"w-4 h-4 mr-2"}),"Zur Warteliste hinzufügen"]})}),(0,b.jsxs)(h.DialogContent,{className:"max-w-lg",children:[(0,b.jsx)(h.DialogHeader,{children:(0,b.jsx)(h.DialogTitle,{children:"Zur Warteliste hinzufügen"})}),(0,b.jsxs)("form",{onSubmit:as,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Bestehender Kunde (optional)"}),(0,b.jsxs)(l.Select,{value:T,onValueChange:function(a){if(U(a),a){let b=B.find(b=>b.id===a);b&&(W(`${b.first_name} ${b.last_name}`),Y(b.email||""),$(b.phone||""))}},children:[(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{placeholder:"Kunde auswählen..."})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"",children:"Neuer Kunde"}),B.map(a=>(0,b.jsxs)(l.SelectItem,{value:a.id,children:[a.first_name," ",a.last_name]},a.id))]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"customer_name",children:"Name *"}),(0,b.jsx)(i.Input,{id:"customer_name",value:V,onChange:a=>W(a.target.value),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"customer_phone",children:"Telefon"}),(0,b.jsx)(i.Input,{id:"customer_phone",value:Z,onChange:a=>$(a.target.value)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"customer_email",children:"E-Mail"}),(0,b.jsx)(i.Input,{id:"customer_email",type:"email",value:X,onChange:a=>Y(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Service *"}),(0,b.jsxs)(l.Select,{value:_,onValueChange:aa,children:[(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{placeholder:"Service auswählen..."})}),(0,b.jsx)(l.SelectContent,{children:w.map(a=>(0,b.jsxs)(l.SelectItem,{value:a.id,children:[a.name," (",a.duration_minutes," Min.)"]},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Bevorzugter Mitarbeiter (optional)"}),(0,b.jsxs)(l.Select,{value:ab,onValueChange:ac,children:[(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{placeholder:"Egal"})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"",children:"Egal"}),C.map(a=>(0,b.jsxs)(l.SelectItem,{value:a.id,children:[a.first_name," ",a.last_name]},a.id))]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"date_from",children:"Datum von *"}),(0,b.jsx)(i.Input,{id:"date_from",type:"date",value:ad,onChange:a=>ae(a.target.value),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"date_to",children:"Datum bis *"}),(0,b.jsx)(i.Input,{id:"date_to",type:"date",value:af,onChange:a=>ag(a.target.value),required:!0})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"time_from",children:"Zeit von (optional)"}),(0,b.jsx)(i.Input,{id:"time_from",type:"time",value:ah,onChange:a=>ai(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"time_to",children:"Zeit bis (optional)"}),(0,b.jsx)(i.Input,{id:"time_to",type:"time",value:aj,onChange:a=>ak(a.target.value)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"priority",children:"Priorität"}),(0,b.jsxs)(l.Select,{value:an,onValueChange:ao,children:[(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"0",children:"Normal"}),(0,b.jsx)(l.SelectItem,{value:"1",children:"Hoch"}),(0,b.jsx)(l.SelectItem,{value:"2",children:"Sehr hoch (VIP)"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"notes",children:"Notizen"}),(0,b.jsx)(k.Textarea,{id:"notes",value:al,onChange:a=>am(a.target.value),placeholder:"z.B. Flexibel bei der Zeit, bevorzugt vormittags..."})]}),(0,b.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>I(!1),children:"Abbrechen"}),(0,b.jsx)(d.Button,{type:"submit",disabled:R,children:R?"Speichert...":"Hinzufügen"})]})]})]})]})}),(0,b.jsx)(h.Dialog,{open:J,onOpenChange:K,children:(0,b.jsxs)(h.DialogContent,{children:[(0,b.jsx)(h.DialogHeader,{children:(0,b.jsx)(h.DialogTitle,{children:"Kunde benachrichtigen"})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Wähle den verfügbaren Termin aus, über den du ",L?.customer_name," benachrichtigen möchtest:"]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"notify_date",children:"Datum"}),(0,b.jsx)(i.Input,{id:"notify_date",type:"date",value:N,onChange:a=>O(a.target.value),min:L?.preferred_date_from,max:L?.preferred_date_to})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"notify_time",children:"Uhrzeit"}),(0,b.jsx)(i.Input,{id:"notify_time",type:"time",value:P,onChange:a=>Q(a.target.value)})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>K(!1),children:"Abbrechen"}),(0,b.jsxs)(d.Button,{onClick:ax,disabled:R||!N||!P,children:[(0,b.jsx)(q.MessageCircle,{className:"w-4 h-4 mr-2"}),R?"Öffnet WhatsApp...":"Per WhatsApp benachrichtigen"]})]})]})]})}),(0,b.jsxs)(g.Tabs,{defaultValue:"waiting",className:"w-full",children:[(0,b.jsxs)(g.TabsList,{className:"grid w-full grid-cols-3",children:[(0,b.jsxs)(g.TabsTrigger,{value:"waiting",children:["Wartend (",ap.length,")"]}),(0,b.jsxs)(g.TabsTrigger,{value:"notified",children:["Benachrichtigt (",aq.length,")"]}),(0,b.jsxs)(g.TabsTrigger,{value:"completed",children:["Abgeschlossen (",ar.length,")"]})]}),(0,b.jsx)(g.TabsContent,{value:"waiting",className:"mt-6",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Wartende Kunden"})}),(0,b.jsx)(e.CardContent,{children:0===ap.length?(0,b.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"Keine Kunden auf der Warteliste"}):(0,b.jsx)("div",{className:"space-y-4",children:ap.map(aA)})})]})}),(0,b.jsx)(g.TabsContent,{value:"notified",className:"mt-6",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Benachrichtigte Kunden"})}),(0,b.jsx)(e.CardContent,{children:0===aq.length?(0,b.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"Keine benachrichtigten Kunden"}):(0,b.jsx)("div",{className:"space-y-4",children:aq.map(aA)})})]})}),(0,b.jsx)(g.TabsContent,{value:"completed",className:"mt-6",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Abgeschlossene Einträge"})}),(0,b.jsx)(e.CardContent,{children:0===ar.length?(0,b.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"Keine abgeschlossenen Einträge"}):(0,b.jsx)("div",{className:"space-y-4",children:ar.map(aA)})})]})})]})]})}a.s(["WaitlistManager",()=>B],41893)}];

//# sourceMappingURL=apps_web_app_dashboard_waitlist_waitlist-manager_tsx_aad2cdea._.js.map