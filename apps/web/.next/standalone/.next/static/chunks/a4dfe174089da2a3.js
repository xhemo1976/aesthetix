(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,58294,(e,t,r)=>{t.exports=e.r(56984)},66691,94237,e=>{"use strict";var t=e.i(80506),r=e.i(778),n=e.i(7284);let s=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=n.clsx,a=(e,t)=>r=>{var n;if((null==t?void 0:t.variants)==null)return i(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:a,defaultVariants:l}=t,o=Object.keys(a).map(e=>{let t=null==r?void 0:r[e],n=null==l?void 0:l[e];if(null===t)return null;let i=s(t)||s(n);return a[e][i]}),d=r&&Object.entries(r).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return i(e,o,null==t||null==(n=t.compoundVariants)?void 0:n.reduce((e,t)=>{let{class:r,className:n,...s}=t;return Object.entries(s).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...l,...d}[t]):({...l,...d})[t]===r})?[...e,r,n]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)};e.s(["cva",0,a],94237);var l=e.i(52236);let o=a("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef(({className:e,variant:r,size:n,asChild:s=!1,...i},a)=>(0,t.jsx)("button",{className:(0,l.cn)(o({variant:r,size:n,className:e})),ref:a,...i}));d.displayName="Button",e.s(["Button",()=>d],66691)},70317,e=>{"use strict";var t=e.i(80506),r=e.i(778),n=e.i(52236);let s=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...r}));s.displayName="Card";let i=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...r}));i.displayName="CardHeader";let a=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,n.cn)("font-semibold leading-none tracking-tight",e),...r}));a.displayName="CardTitle";let l=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",e),...r}));l.displayName="CardDescription";let o=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",e),...r}));o.displayName="CardContent",r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>o,"CardDescription",()=>l,"CardHeader",()=>i,"CardTitle",()=>a])},24911,e=>{"use strict";var t=e.i(80506),r=e.i(778),n=e.i(52236);let s=r.forwardRef(({className:e,type:r,...s},i)=>(0,t.jsx)("input",{type:r,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...s}));s.displayName="Input",e.s(["Input",()=>s])},25466,e=>{"use strict";var t=e.i(80506),r=e.i(778),n=e.i(52236);let s=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("label",{ref:s,className:(0,n.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...r}));s.displayName="Label",e.s(["Label",()=>s])},3812,e=>{"use strict";let t=(0,e.i(49623).default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);e.s(["MessageCircle",()=>t],3812)},13862,66640,e=>{"use strict";let t=(0,e.i(49623).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["default",()=>t],66640),e.s(["Clock",()=>t],13862)},71628,e=>{"use strict";let t=(0,e.i(49623).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],71628)},53668,e=>{"use strict";let t=(0,e.i(49623).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],53668)},56625,e=>{"use strict";let t=(0,e.i(49623).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],56625)},98048,e=>{"use strict";function t(e,t){let r=e.replace(/[\s\-\(\)]/g,""),n=encodeURIComponent(t);return`https://wa.me/${r}?text=${n}`}function r(e){return`Hallo ${e.customerName}! ğŸ‘‹

Dies ist eine Erinnerung an Ihren Termin bei ${e.clinicName}:

ğŸ“… Datum: ${e.date}
ğŸ• Uhrzeit: ${e.time}
ğŸ’† Behandlung: ${e.serviceName}

Wir freuen uns auf Sie!

Bei Fragen oder Termin\xe4nderungen melden Sie sich gerne.`}function n(e,n,s,i,a,l){return t(e,r({customerName:n,date:s,time:i,serviceName:a,clinicName:l}))}function s(e,r,n,s,i,a,l){var o;let d;return t(e,(o={customerName:r,date:n,time:s,serviceName:i,clinicName:a,confirmationUrl:l},d=`Hallo ${o.customerName}! ğŸ‘‹

Termin-Best\xe4tigung bei ${o.clinicName}:

ğŸ“… Datum: ${o.date}
ğŸ• Uhrzeit: ${o.time}
ğŸ’† Behandlung: ${o.serviceName}`,o.confirmationUrl?`${d}

ğŸ”— Bitte best\xe4tigen Sie Ihren Termin:
${o.confirmationUrl}

Wir freuen uns auf Sie!`:`${d}

Bis bald!`))}function i(e,r,n){var s;return t(e,(s={customerName:r,clinicName:n},`Hallo ${s.customerName}! ğŸ‘‹

Hier ist ${s.clinicName}. `))}e.s(["generateWhatsAppLink",()=>t,"getAppointmentConfirmationLink",()=>s,"getAppointmentReminderLink",()=>n,"getAppointmentReminderMessage",()=>r,"getCustomerContactLink",()=>i])},52160,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={callServer:function(){return i.callServer},createServerReference:function(){return l.createServerReference},findSourceMapURL:function(){return a.findSourceMapURL}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let i=e.r(40558),a=e.r(31316),l=e.r(30278)},28781,e=>{"use strict";let t=(0,e.i(49623).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],28781)},44977,e=>{"use strict";var t=e.i(778);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function n(...e){return t=>{let n=!1,s=e.map(e=>{let s=r(e,t);return n||"function"!=typeof s||(n=!0),s});if(n)return()=>{for(let t=0;t<s.length;t++){let n=s[t];"function"==typeof n?n():r(e[t],null)}}}}function s(...e){return t.useCallback(n(...e),e)}e.s(["composeRefs",()=>n,"useComposedRefs",()=>s])},91967,56207,e=>{"use strict";function t(e,r,{checkForDefaultPrevented:n=!0}={}){return function(t){if(e?.(t),!1===n||!t.defaultPrevented)return r?.(t)}}"undefined"!=typeof window&&window.document&&window.document.createElement,e.s(["composeEventHandlers",()=>t],91967);var r=e.i(778),n=e.i(80506);function s(e,t){let s=r.createContext(t),i=e=>{let{children:t,...i}=e,a=r.useMemo(()=>i,Object.values(i));return(0,n.jsx)(s.Provider,{value:a,children:t})};return i.displayName=e+"Provider",[i,function(n){let i=r.useContext(s);if(i)return i;if(void 0!==t)return t;throw Error(`\`${n}\` must be used within \`${e}\``)}]}function i(e,t=[]){let s=[],a=()=>{let t=s.map(e=>r.createContext(e));return function(n){let s=n?.[e]||t;return r.useMemo(()=>({[`__scope${e}`]:{...n,[e]:s}}),[n,s])}};return a.scopeName=e,[function(t,i){let a=r.createContext(i),l=s.length;s=[...s,i];let o=t=>{let{scope:s,children:i,...o}=t,d=s?.[e]?.[l]||a,c=r.useMemo(()=>o,Object.values(o));return(0,n.jsx)(d.Provider,{value:c,children:i})};return o.displayName=t+"Provider",[o,function(n,s){let o=s?.[e]?.[l]||a,d=r.useContext(o);if(d)return d;if(void 0!==i)return i;throw Error(`\`${n}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let n=()=>{let n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=n.reduce((t,{useScope:r,scopeName:n})=>{let s=r(e)[`__scope${n}`];return{...t,...s}},{});return r.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return n.scopeName=t.scopeName,n}(a,...t)]}e.s(["createContext",()=>s,"createContextScope",()=>i],56207)},61194,27864,e=>{"use strict";var t=e.i(778),r=globalThis?.document?t.useLayoutEffect:()=>{};e.s(["useLayoutEffect",()=>r],27864);var n=t[" useId ".trim().toString()]||(()=>void 0),s=0;function i(e){let[i,a]=t.useState(n());return r(()=>{e||a(e=>e??String(s++))},[e]),e||(i?`radix-${i}`:"")}e.s(["useId",()=>i],61194)},34643,e=>{"use strict";var t=e.i(778),r=e.i(27864);t[" useEffectEvent ".trim().toString()],t[" useInsertionEffect ".trim().toString()];var n=t[" useInsertionEffect ".trim().toString()]||r.useLayoutEffect;function s({prop:e,defaultProp:r,onChange:s=()=>{},caller:i}){let[a,l,o]=function({defaultProp:e,onChange:r}){let[s,i]=t.useState(e),a=t.useRef(s),l=t.useRef(r);return n(()=>{l.current=r},[r]),t.useEffect(()=>{a.current!==s&&(l.current?.(s),a.current=s)},[s,a]),[s,i,l]}({defaultProp:r,onChange:s}),d=void 0!==e,c=d?e:a;{let r=t.useRef(void 0!==e);t.useEffect(()=>{let e=r.current;if(e!==d){let t=d?"controlled":"uncontrolled";console.warn(`${i} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}r.current=d},[d,i])}return[c,t.useCallback(t=>{if(d){let r="function"==typeof t?t(e):t;r!==e&&o.current?.(r)}else l(t)},[d,e,l,o])]}Symbol("RADIX:SYNC_STATE"),e.s(["useControllableState",()=>s],34643)},93074,e=>{"use strict";var t=e.i(778),r=e.i(44977),n=e.i(80506);function s(e){var s;let i,l=(s=e,(i=t.forwardRef((e,n)=>{let{children:s,...i}=e;if(t.isValidElement(s)){var a;let e,l,o=(a=s,(l=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(l=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref),d=function(e,t){let r={...t};for(let n in t){let s=e[n],i=t[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...e)=>{let t=i(...e);return s(...e),t}:s&&(r[n]=s):"style"===n?r[n]={...s,...i}:"className"===n&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...e,...r}}(i,s.props);return s.type!==t.Fragment&&(d.ref=n?(0,r.composeRefs)(n,o):o),t.cloneElement(s,d)}return t.Children.count(s)>1?t.Children.only(null):null})).displayName=`${s}.SlotClone`,i),o=t.forwardRef((e,r)=>{let{children:s,...i}=e,o=t.Children.toArray(s),d=o.find(a);if(d){let e=d.props.children,s=o.map(r=>r!==d?r:t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null);return(0,n.jsx)(l,{...i,ref:r,children:t.isValidElement(e)?t.cloneElement(e,void 0,s):null})}return(0,n.jsx)(l,{...i,ref:r,children:s})});return o.displayName=`${e}.Slot`,o}var i=Symbol("radix.slottable");function a(e){return t.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===i}e.s(["createSlot",()=>s])},56872,52960,e=>{"use strict";var t=e.i(778),r=e.i(50919),n=e.i(93074),s=e.i(80506),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let i=(0,n.createSlot)(`Primitive.${r}`),a=t.forwardRef((e,t)=>{let{asChild:n,...a}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(n?i:r,{...a,ref:t})});return a.displayName=`Primitive.${r}`,{...e,[r]:a}},{});function a(e,t){e&&r.flushSync(()=>e.dispatchEvent(t))}function l(e){let r=t.useRef(e);return t.useEffect(()=>{r.current=e}),t.useMemo(()=>(...e)=>r.current?.(...e),[])}e.s(["Primitive",()=>i,"dispatchDiscreteCustomEvent",()=>a],56872),e.s(["useCallbackRef",()=>l],52960)},53747,e=>{"use strict";var t=e.i(778),r=e.i(44977),n=e.i(27864),s=e=>{var s;let a,l,{present:o,children:d}=e,c=function(e){var r,s;let[a,l]=t.useState(),o=t.useRef(null),d=t.useRef(e),c=t.useRef("none"),[u,m]=(r=e?"mounted":"unmounted",s={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},t.useReducer((e,t)=>s[e][t]??e,r));return t.useEffect(()=>{let e=i(o.current);c.current="mounted"===u?e:"none"},[u]),(0,n.useLayoutEffect)(()=>{let t=o.current,r=d.current;if(r!==e){let n=c.current,s=i(t);e?m("MOUNT"):"none"===s||t?.display==="none"?m("UNMOUNT"):r&&n!==s?m("ANIMATION_OUT"):m("UNMOUNT"),d.current=e}},[e,m]),(0,n.useLayoutEffect)(()=>{if(a){let e,t=a.ownerDocument.defaultView??window,r=r=>{let n=i(o.current).includes(CSS.escape(r.animationName));if(r.target===a&&n&&(m("ANIMATION_END"),!d.current)){let r=a.style.animationFillMode;a.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===a.style.animationFillMode&&(a.style.animationFillMode=r)})}},n=e=>{e.target===a&&(c.current=i(o.current))};return a.addEventListener("animationstart",n),a.addEventListener("animationcancel",r),a.addEventListener("animationend",r),()=>{t.clearTimeout(e),a.removeEventListener("animationstart",n),a.removeEventListener("animationcancel",r),a.removeEventListener("animationend",r)}}m("ANIMATION_END")},[a,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:t.useCallback(e=>{o.current=e?getComputedStyle(e):null,l(e)},[])}}(o),u="function"==typeof d?d({present:c.isPresent}):t.Children.only(d),m=(0,r.useComposedRefs)(c.ref,(s=u,(l=(a=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?s.ref:(l=(a=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?s.props.ref:s.props.ref||s.ref));return"function"==typeof d||c.isPresent?t.cloneElement(u,{ref:m}):null};function i(e){return e?.animationName||"none"}s.displayName="Presence",e.s(["Presence",()=>s])},43293,e=>{"use strict";let t=(0,e.i(49623).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],43293)},14136,e=>{"use strict";let t=(0,e.i(49623).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],14136)},95953,e=>{"use strict";let t=(0,e.i(49623).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>t],95953)},34315,e=>{"use strict";let t=(0,e.i(49623).default)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);e.s(["Bell",()=>t],34315)},29126,e=>{"use strict";let t=(0,e.i(49623).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],29126)},33275,22827,e=>{"use strict";var t=e.i(52160);let r=(0,t.createServerReference)("4026c9fd8c6a0c2a149b046d98dce7640094e3e759",t.callServer,void 0,t.findSourceMapURL,"createAppointment");e.s(["createAppointment",()=>r],33275);let n=(0,t.createServerReference)("60a4f4ade2852b49b8a0f9a20d20162d506a525fba",t.callServer,void 0,t.findSourceMapURL,"updateAppointment");e.s(["updateAppointment",()=>n],22827)},7053,e=>{"use strict";var t=e.i(80506),r=e.i(778),n=e.i(82879),s=e.i(66691),i=e.i(24911),a=e.i(25466),l=e.i(33275),o=e.i(22827),d=e.i(58294),c=e.i(13862),u=e.i(56625),m=e.i(29126);let f=[{value:"scheduled",label:"Geplant"},{value:"confirmed",label:"BestÃ¤tigt"},{value:"completed",label:"Abgeschlossen"},{value:"cancelled",label:"Abgesagt"},{value:"no_show",label:"Nicht erschienen"}],p={0:"sunday",1:"monday",2:"tuesday",3:"wednesday",4:"thursday",5:"friday",6:"saturday"};function h({open:e,onOpenChange:h,appointment:x,customers:v,services:g,employees:b,existingAppointments:y=[]}){let N=(0,d.useRouter)(),[j,w]=(0,r.useState)(!1),[C,_]=(0,r.useState)(null),k=!!x,[S,M]=(0,r.useState)(""),[R,A]=(0,r.useState)(""),[T,E]=(0,r.useState)(""),[D,$]=(0,r.useState)(""),[B,O]=(0,r.useState)(""),[L,U]=(0,r.useState)("scheduled"),[I,P]=(0,r.useState)(""),[z,F]=(0,r.useState)([]);async function W(e){e.preventDefault(),w(!0),_(null);let t=new FormData;t.set("customer_id",S),t.set("service_id",R),t.set("employee_id",T),t.set("appointment_date",D),t.set("appointment_time",B),t.set("status",L),t.set("customer_notes",I);let r=k?await (0,o.updateAppointment)(x.id,t):await (0,l.createAppointment)(t);r.error?(_(r.error),w(!1)):(w(!1),h(!1),N.refresh())}(0,r.useEffect)(()=>{e&&(x?(M(x.customer_id),A(x.service_id),E(x.employee_id||""),$(new Date(x.start_time).toISOString().split("T")[0]),O(new Date(x.start_time).toTimeString().slice(0,5)),U(x.status),P(x.customer_notes||"")):(M(""),A(""),E(""),$(""),O(""),U("scheduled"),P("")),_(null))},[e,x]),(0,r.useEffect)(()=>{if(!D||!R)return void F([]);let e=g.find(e=>e.id===R);if(!e)return void F([]);let t=e.duration_minutes,r=p[new Date(D).getDay()],n="09:00",s="18:00";if(T){let e=b.find(e=>e.id===T);if(e?.work_schedule?.[r])n=e.work_schedule[r].start,s=e.work_schedule[r].end;else if(e?.work_schedule&&Object.keys(e.work_schedule).length>0)return void F([])}let i=[],[a,l]=n.split(":").map(Number),[o,d]=s.split(":").map(Number),c=60*a+l,u=60*o+d;for(let e=c;e+t<=u;e+=30){let r=Math.floor(e/60),n=e%60,s=`${r.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`,a=new Date(`${D}T${s}`),l=new Date(a.getTime()+6e4*t);y.some(e=>{if("cancelled"===e.status||x&&e.id===x.id||T&&e.employee_id!==T)return!1;let t=new Date(e.start_time);return a<new Date(e.end_time)&&l>t})||i.push(s)}F(i)},[D,T,R,g,b,y,x]);let H=g.find(e=>e.id===R);return(0,t.jsx)(n.Dialog,{open:e,onOpenChange:h,children:(0,t.jsxs)(n.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(n.DialogHeader,{children:[(0,t.jsx)(n.DialogTitle,{children:k?"Termin bearbeiten":"Neuer Termin"}),(0,t.jsx)(n.DialogDescription,{children:k?"Aktualisiere die Termin-Details":"Erstelle einen neuen Termin"})]}),(0,t.jsxs)("form",{onSubmit:W,className:"space-y-4",children:[C&&(0,t.jsxs)("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-md flex items-start gap-2",children:[(0,t.jsx)(u.AlertCircle,{className:"w-5 h-5 text-destructive flex-shrink-0 mt-0.5"}),(0,t.jsx)("p",{className:"text-sm text-destructive",children:C})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a.Label,{htmlFor:"customer_id",children:"Kunde *"}),(0,t.jsxs)("select",{id:"customer_id",value:S,onChange:e=>M(e.target.value),required:!0,disabled:j,className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:[(0,t.jsx)("option",{value:"",children:"Kunde auswÃ¤hlen"}),v.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name]},e.id))]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a.Label,{htmlFor:"service_id",children:"Behandlung *"}),(0,t.jsxs)("select",{id:"service_id",value:R,onChange:e=>A(e.target.value),required:!0,disabled:j,className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:[(0,t.jsx)("option",{value:"",children:"Behandlung auswÃ¤hlen"}),g.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," (",e.duration_minutes," Min)"]},e.id))]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a.Label,{htmlFor:"employee_id",children:"Mitarbeiter"}),(0,t.jsxs)("select",{id:"employee_id",value:T,onChange:e=>{E(e.target.value),O("")},disabled:j,className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:[(0,t.jsx)("option",{value:"",children:"Kein Mitarbeiter zugewiesen"}),b.filter(e=>e.is_active).map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name," (",e.role,")"]},e.id))]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a.Label,{htmlFor:"appointment_date",children:"Datum *"}),(0,t.jsx)(i.Input,{id:"appointment_date",type:"date",value:D,onChange:e=>{$(e.target.value),O("")},required:!0,disabled:j})]}),D&&R&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(a.Label,{className:"flex items-center gap-2",children:[(0,t.jsx)(c.Clock,{className:"w-4 h-4"}),"Uhrzeit wÃ¤hlen *",H&&(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",H.duration_minutes," Min pro Termin)"]})]}),z.length>0?(0,t.jsx)("div",{className:"flex flex-wrap gap-2 p-3 bg-muted/30 rounded-lg max-h-40 overflow-y-auto",children:z.map(e=>(0,t.jsxs)(s.Button,{type:"button",variant:B===e?"default":"outline",size:"sm",onClick:()=>O(e),className:"text-xs",disabled:j,children:[e,B===e&&(0,t.jsx)(m.CheckCircle2,{className:"w-3 h-3 ml-1"})]},e))}):(0,t.jsx)("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-md text-sm text-orange-800",children:T?"Keine verfÃ¼gbaren Zeiten fÃ¼r diesen Mitarbeiter an diesem Tag.":"Bitte wÃ¤hle zuerst einen Mitarbeiter, um verfÃ¼gbare Zeiten zu sehen."}),B&&(0,t.jsxs)("div",{className:"text-sm text-green-600 flex items-center gap-1",children:[(0,t.jsx)(m.CheckCircle2,{className:"w-4 h-4"}),"GewÃ¤hlte Zeit: ",(0,t.jsxs)("strong",{children:[B," Uhr"]})]}),(0,t.jsx)("input",{type:"hidden",name:"appointment_time",value:B,required:!0})]}),!D&&R&&(0,t.jsx)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-800",children:"Bitte wÃ¤hle ein Datum, um verfÃ¼gbare Zeiten zu sehen."}),!R&&(0,t.jsx)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-800",children:"Bitte wÃ¤hle eine Behandlung, um verfÃ¼gbare Zeiten zu sehen."}),k&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a.Label,{htmlFor:"status",children:"Status *"}),(0,t.jsx)("select",{id:"status",value:L,onChange:e=>U(e.target.value),required:!0,disabled:j,className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:f.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a.Label,{htmlFor:"customer_notes",children:"Notizen"}),(0,t.jsx)("textarea",{id:"customer_notes",placeholder:"Besondere WÃ¼nsche, Hinweise...",value:I,onChange:e=>P(e.target.value),disabled:j,rows:3,className:"flex w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,t.jsxs)(n.DialogFooter,{children:[(0,t.jsx)(s.Button,{type:"button",variant:"outline",onClick:()=>h(!1),disabled:j,children:"Abbrechen"}),(0,t.jsx)(s.Button,{type:"submit",disabled:j,children:j?"Wird gespeichert...":k?"Speichern":"Erstellen"})]})]})]})})}e.s(["AppointmentDialog",()=>h])},62835,e=>{"use strict";e.i(27171);var t=e.i(80506),r=e.i(778),n=e.i(66691),s=e.i(70317),i=e.i(43293),a=e.i(95953),l=e.i(14136),o=e.i(71628),d=e.i(13862),c=e.i(29126),u=e.i(53668),m=e.i(56625),f=e.i(3812),p=e.i(34315),h=e.i(7053),x=e.i(52160);let v=(0,x.createServerReference)("4040a59ddfda05d6095b129d2d9e5edf54d6caeb0c",x.callServer,void 0,x.findSourceMapURL,"deleteAppointment"),g=(0,x.createServerReference)("6058c3eb3c1d0a7452f1f43331c272ffec3d595ddb",x.callServer,void 0,x.findSourceMapURL,"updateAppointmentStatus");var b=e.i(98048);let y={scheduled:{label:"Geplant",color:"bg-blue-100 text-blue-800",icon:o.Calendar},confirmed:{label:"BestÃ¤tigt",color:"bg-green-100 text-green-800",icon:c.CheckCircle2},completed:{label:"Abgeschlossen",color:"bg-gray-100 text-gray-800",icon:c.CheckCircle2},cancelled:{label:"Abgesagt",color:"bg-red-100 text-red-800",icon:u.XCircle},no_show:{label:"Nicht erschienen",color:"bg-orange-100 text-orange-800",icon:m.AlertCircle}};function N({initialAppointments:e,customers:c,services:u,employees:m,clinicWhatsApp:x,clinicName:N}){let[j,w]=(0,r.useState)(e),[C,_]=(0,r.useState)(!1),[k,S]=(0,r.useState)(null);async function M(e){!confirm("MÃ¶chtest du diesen Termin wirklich lÃ¶schen?")||(await v(e)).error||w(j.filter(t=>t.id!==e))}async function R(e,t){await g(e,t),w(j.map(r=>r.id===e?{...r,status:t}:r))}function A(){S(null),_(!0)}function T(e){return new Date(e).toLocaleDateString("de-DE",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}function E(e){return new Date(e).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}function D(e){return new Date(e).toISOString().split("T")[0]}let $=j.reduce((e,t)=>{let r=D(t.start_time);return e[r]||(e[r]=[]),e[r].push(t),e},{}),B=Object.keys($).sort();return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[j.length," Termin",1!==j.length?"e":""]}),(0,t.jsxs)(n.Button,{onClick:A,children:[(0,t.jsx)(i.Plus,{className:"w-4 h-4 mr-2"}),"Neuer Termin"]})]}),0===j.length?(0,t.jsx)(s.Card,{children:(0,t.jsx)(s.CardContent,{className:"py-12",children:(0,t.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,t.jsx)(o.Calendar,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{className:"mb-4",children:"Noch keine Termine angelegt"}),(0,t.jsxs)(n.Button,{onClick:A,children:[(0,t.jsx)(i.Plus,{className:"w-4 h-4 mr-2"}),"Ersten Termin erstellen"]})]})})}):(0,t.jsx)("div",{className:"space-y-6",children:B.map(e=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,t.jsx)(o.Calendar,{className:"w-5 h-5"}),T(e)]}),(0,t.jsx)(s.Card,{children:(0,t.jsx)(s.CardContent,{className:"p-0",children:(0,t.jsx)("div",{className:"divide-y",children:$[e].map(e=>{let r=y[e.status]?.icon||o.Calendar,s=y[e.status];return(0,t.jsx)("div",{className:"p-4 hover:bg-muted/50 transition-colors",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(d.Clock,{className:"w-4 h-4 text-muted-foreground"}),(0,t.jsxs)("span",{className:"font-semibold",children:[E(e.start_time)," - ",E(e.end_time)]})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"font-medium",children:[e.customers.first_name," ",e.customers.last_name]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.services.name," (",e.services.duration_minutes," Min)"]}),e.employees&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["ğŸ‘¤ ",e.employees.first_name," ",e.employees.last_name]}),e.customer_notes&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:["ğŸ’¬ ",e.customer_notes]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsxs)("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${s?.color}`,children:[(0,t.jsx)(r,{className:"w-3 h-3"}),s?.label]}),"confirmed"===e.customer_response&&(0,t.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"âœ“ Vom Kunden bestÃ¤tigt"}),"declined"===e.customer_response&&(0,t.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"âœ— Vom Kunden abgesagt"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[x&&e.customers&&(0,t.jsxs)(t.Fragment,{children:["scheduled"===e.status&&e.customers.phone&&(0,t.jsx)(n.Button,{variant:"outline",size:"sm",asChild:!0,title:"Termin-BestÃ¤tigung per WhatsApp senden",className:"text-green-600 border-green-300 hover:bg-green-50",children:(0,t.jsxs)("a",{href:(0,b.getAppointmentConfirmationLink)(e.customers.phone,`${e.customers.first_name} ${e.customers.last_name}`,T(D(e.start_time)),E(e.start_time),e.services.name,N,e.confirmation_token?`http://localhost:3000/confirm/${e.confirmation_token}`:void 0),target:"_blank",rel:"noopener noreferrer",children:[(0,t.jsx)(f.MessageCircle,{className:"w-4 h-4 mr-1"}),"BestÃ¤tigen"]})}),("scheduled"===e.status||"confirmed"===e.status)&&(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",asChild:!0,title:"Erinnerung per WhatsApp senden",children:(0,t.jsx)("a",{href:(0,b.getAppointmentReminderLink)(x,`${e.customers.first_name} ${e.customers.last_name}`,T(D(e.start_time)),E(e.start_time),e.services.name,N),target:"_blank",rel:"noopener noreferrer",children:(0,t.jsx)(p.Bell,{className:"w-4 h-4 text-green-600"})})})]}),"scheduled"===e.status&&(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:()=>R(e.id,"confirmed"),children:"BestÃ¤tigen"}),"confirmed"===e.status&&(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:()=>R(e.id,"completed"),children:"AbschlieÃŸen"}),(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>{S(e),_(!0)},children:(0,t.jsx)(a.Edit,{className:"w-4 h-4"})}),(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>M(e.id),children:(0,t.jsx)(l.Trash2,{className:"w-4 h-4 text-destructive"})})]})]})},e.id)})})})})]},e))}),(0,t.jsx)(h.AppointmentDialog,{open:C,onOpenChange:function(){_(!1),S(null)},appointment:k,customers:c,services:u,employees:m,existingAppointments:j.map(e=>({id:e.id,employee_id:e.employee_id,start_time:e.start_time,end_time:e.end_time,status:e.status}))})]})}e.s(["AppointmentsList",()=>N],62835)}]);