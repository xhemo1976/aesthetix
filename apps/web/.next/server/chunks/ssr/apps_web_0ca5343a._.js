module.exports=[71118,a=>{"use strict";var b=a.i(38735),c=a.i(56511),d=a.i(80159),e=a.i(81182);async function f(){let a=await (0,d.createClient)(),{data:b,error:c}=await a.from("services").select("*").order("created_at",{ascending:!1});return c?(console.error("Error fetching services:",c),{services:[],error:c.message}):{services:b,error:null}}async function g(a){let b=await (0,d.createClient)(),c=a.name.split(".").pop(),e=`${Date.now()}-${Math.random().toString(36).substring(7)}.${c}`,f=`dishes/${e}`,g=new Uint8Array(await a.arrayBuffer()),{error:h}=await b.storage.from("dish-images").upload(f,g,{contentType:a.type,cacheControl:"3600"});if(h)return console.error("Error uploading image:",h),{url:null,error:h.message};let{data:{publicUrl:i}}=b.storage.from("dish-images").getPublicUrl(f);return{url:i,error:null}}async function h(a){let b=await (0,d.createClient)(),f=(0,e.createAdminClient)(),{data:{user:g}}=await b.auth.getUser();if(!g)return{error:"Nicht authentifiziert"};let{data:h}=await f.from("users").select("tenant_id").eq("id",g.id).single();if(!h)return{error:"Profil nicht gefunden"};let i=a.get("name"),j=a.get("description"),k=a.get("category"),l=parseFloat(a.get("price")),m=parseInt(a.get("duration_minutes")),n=a.get("image_url")||null,o=a.get("category_image_url")||null,p=a.get("allergens"),q=p?JSON.parse(p):[],r=a.get("diet_labels");r&&JSON.parse(r);let s=a.get("other_labels");s&&JSON.parse(s);let t=a.get("cross_contamination");t&&JSON.parse(t);let u="true"===a.get("is_vegetarian"),v="true"===a.get("is_vegan"),w="true"===a.get("is_spicy"),{error:x}=await b.from("services").insert({tenant_id:h.tenant_id,name:i,description:j,category:k,category_image_url:o||null,price:l,duration_minutes:m,is_active:!0,image_url:n||null,allergens:q.length>0?q:null,is_vegetarian:u,is_vegan:v,is_spicy:w});return x?(console.error("Error creating service:",x),{error:x.message}):(k&&o&&await b.from("services").update({category_image_url:o}).eq("tenant_id",h.tenant_id).eq("category",k),(0,c.revalidatePath)("/dashboard/services"),{error:null})}async function i(a,b){let e=await (0,d.createClient)(),f=b.get("name"),g=b.get("description"),h=b.get("category"),i=parseFloat(b.get("price")),j=parseInt(b.get("duration_minutes")),k=b.get("image_url")||null,l=b.get("category_image_url")||null,m=b.get("allergens"),n=m?JSON.parse(m):[],o="true"===b.get("is_vegetarian"),p="true"===b.get("is_vegan"),q="true"===b.get("is_spicy"),{error:r}=await e.from("services").update({name:f,description:g,category:h,category_image_url:l||null,price:i,duration_minutes:j,image_url:k||null,allergens:n.length>0?n:null,is_vegetarian:o,is_vegan:p,is_spicy:q}).eq("id",a);if(r)return console.error("Error updating service:",r),{error:r.message};if(h&&l){let{data:b}=await e.from("services").select("tenant_id").eq("id",a).single();b&&await e.from("services").update({category_image_url:l}).eq("tenant_id",b.tenant_id).eq("category",h)}return(0,c.revalidatePath)("/dashboard/services"),{error:null}}async function j(a){let b=await (0,d.createClient)(),{error:e}=await b.from("services").delete().eq("id",a);return e?(console.error("Error deleting service:",e),{error:e.message}):((0,c.revalidatePath)("/dashboard/services"),{error:null})}async function k(a,b){let e=await (0,d.createClient)(),{error:f}=await e.from("services").update({is_active:!b}).eq("id",a);return f?(console.error("Error toggling service status:",f),{error:f.message}):((0,c.revalidatePath)("/dashboard/services"),{error:null})}async function l(){let a=await (0,d.createClient)(),{data:b,error:c}=await a.from("services").select("name, description, category, price, duration_minutes, is_active, image_url, category_image_url, allergens, diet_labels, other_labels, cross_contamination, is_vegetarian, is_vegan, is_spicy").order("category",{ascending:!0}).order("name",{ascending:!0});return c?(console.error("Error exporting services:",c),{services:[],error:c.message}):{services:b,error:null}}async function m(a){let b=await (0,d.createClient)(),f=(0,e.createAdminClient)(),{data:{user:g}}=await b.auth.getUser();if(!g)return{error:"Nicht authentifiziert",imported:0};let{data:h}=await f.from("users").select("tenant_id").eq("id",g.id).single();if(!h)return{error:"Profil nicht gefunden",imported:0};let i=0,j=[];for(let c of a){if(!c.name||void 0===c.price||void 0===c.duration_minutes){j.push(`\xdcbersprungen: "${c.name||"Unbenannt"}" - Name, Preis oder Dauer fehlt`);continue}let{error:a}=await b.from("services").insert({tenant_id:h.tenant_id,name:c.name,description:c.description||null,category:c.category||null,price:c.price,duration_minutes:c.duration_minutes,is_active:!1!==c.is_active,image_url:c.image_url||null,category_image_url:c.category_image_url||null,allergens:c.allergens?.length?c.allergens:null,diet_labels:c.diet_labels?.length?c.diet_labels:null,other_labels:c.other_labels?.length?c.other_labels:null,cross_contamination:c.cross_contamination?.length?c.cross_contamination:null,is_vegetarian:c.is_vegetarian||!1,is_vegan:c.is_vegan||!1,is_spicy:c.is_spicy||!1});a?j.push(`Fehler bei "${c.name}": ${a.message}`):i++}return(0,c.revalidatePath)("/dashboard/services"),{error:j.length>0?j.join("\n"):null,imported:i,total:a.length}}(0,a.i(98246).ensureServerEntryExports)([f,g,h,i,j,k,l,m]),(0,b.registerServerReference)(f,"005d4a16cc3f1c9d6de42a96aa62f2bab538afa94b",null),(0,b.registerServerReference)(g,"4031f14c1707f0e37da0005df8fa8ab36c1a3f5935",null),(0,b.registerServerReference)(h,"402cd21ffb7a3c56b09af06fb4c5043b38c5a55190",null),(0,b.registerServerReference)(i,"608de8ff0a4bdc697186ecb3f9f725e339083da387",null),(0,b.registerServerReference)(j,"4072eae6cf452ff8a263c5ef9e89fb633185d5b94d",null),(0,b.registerServerReference)(k,"60e0e2c66009f6838a672eccb9b91822df45af2e93",null),(0,b.registerServerReference)(l,"0042a2abe349a413d4622436da0130103736329c4f",null),(0,b.registerServerReference)(m,"40a31f38d9ffa3be3e030d3686f3cc427ead83e6d7",null),a.s(["createService",()=>h,"deleteService",()=>j,"exportServices",()=>l,"getServices",()=>f,"importServices",()=>m,"toggleServiceStatus",()=>k,"updateService",()=>i,"uploadServiceImage",()=>g])},53083,a=>{"use strict";var b=a.i(76392),c=a.i(71118);a.s([],77995),a.i(77995),a.s(["0042a2abe349a413d4622436da0130103736329c4f",()=>c.exportServices,"005d4a16cc3f1c9d6de42a96aa62f2bab538afa94b",()=>c.getServices,"00ea5d6db9aa78d155ad7148c00d987a78197cad0e",()=>b.logout,"402cd21ffb7a3c56b09af06fb4c5043b38c5a55190",()=>c.createService,"4031f14c1707f0e37da0005df8fa8ab36c1a3f5935",()=>c.uploadServiceImage,"40557600bffd5a2c9eccc9fb8b66b41ea0de68fa87",()=>b.login,"4072eae6cf452ff8a263c5ef9e89fb633185d5b94d",()=>c.deleteService,"40a31f38d9ffa3be3e030d3686f3cc427ead83e6d7",()=>c.importServices,"40edf544285d63aedbf98dd3fd472b99b616040b0a",()=>b.signup,"608de8ff0a4bdc697186ecb3f9f725e339083da387",()=>c.updateService,"60e0e2c66009f6838a672eccb9b91822df45af2e93",()=>c.toggleServiceStatus],53083)}];

//# sourceMappingURL=apps_web_0ca5343a._.js.map