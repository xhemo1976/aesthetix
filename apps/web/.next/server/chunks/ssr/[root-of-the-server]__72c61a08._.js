module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},36827,(a,b,c)=>{"use strict";b.exports=a.r(96135).vendored.contexts.HooksClientContext},25820,(a,b,c)=>{"use strict";b.exports=a.r(96135).vendored.contexts.ServerInsertedHtml},83589,(a,b,c)=>{"use strict";b.exports=a.r(96135).vendored["react-ssr"].ReactDOM},21798,2231,a=>{"use strict";let b=(0,a.i(72873).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);a.s(["default",()=>b],2231),a.s(["Clock",()=>b],21798)},99756,a=>{"use strict";let b=(0,a.i(72873).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);a.s(["Calendar",()=>b],99756)},69544,a=>{"use strict";let b=(0,a.i(72873).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);a.s(["Users",()=>b],69544)},49453,a=>{"use strict";let b=(0,a.i(72873).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);a.s(["User",()=>b],49453)},80098,a=>{"use strict";let b=(0,a.i(72873).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);a.s(["Check",()=>b],80098)},64706,a=>{"use strict";let b=(0,a.i(72873).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);a.s(["ChevronDown",()=>b],64706)},10668,a=>{"use strict";let b=(0,a.i(72873).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],10668)},28728,30635,a=>{"use strict";var b=a.i(92989),c=a.i(22114),d=a.i(49863),e=a.i(93430),f=a.i(50586);function g(a){let g=a+"CollectionProvider",[h,i]=(0,c.createContextScope)(g),[j,k]=h(g,{collectionRef:{current:null},itemMap:new Map}),l=a=>{let{scope:c,children:d}=a,e=b.default.useRef(null),g=b.default.useRef(new Map).current;return(0,f.jsx)(j,{scope:c,itemMap:g,collectionRef:e,children:d})};l.displayName=g;let m=a+"CollectionSlot",n=(0,e.createSlot)(m),o=b.default.forwardRef((a,b)=>{let{scope:c,children:e}=a,g=k(m,c),h=(0,d.useComposedRefs)(b,g.collectionRef);return(0,f.jsx)(n,{ref:h,children:e})});o.displayName=m;let p=a+"CollectionItemSlot",q="data-radix-collection-item",r=(0,e.createSlot)(p),s=b.default.forwardRef((a,c)=>{let{scope:e,children:g,...h}=a,i=b.default.useRef(null),j=(0,d.useComposedRefs)(c,i),l=k(p,e);return b.default.useEffect(()=>(l.itemMap.set(i,{ref:i,...h}),()=>void l.itemMap.delete(i))),(0,f.jsx)(r,{...{[q]:""},ref:j,children:g})});return s.displayName=p,[{Provider:l,Slot:o,ItemSlot:s},function(c){let d=k(a+"CollectionConsumer",c);return b.default.useCallback(()=>{let a=d.collectionRef.current;if(!a)return[];let b=Array.from(a.querySelectorAll(`[${q}]`));return Array.from(d.itemMap.values()).sort((a,c)=>b.indexOf(a.ref.current)-b.indexOf(c.ref.current))},[d.collectionRef,d.itemMap])},i]}var h=new WeakMap;function i(a,b){var c,d;let e,f,g;if("at"in Array.prototype)return Array.prototype.at.call(a,b);let h=(c=a,d=b,e=c.length,(g=(f=j(d))>=0?f:e+f)<0||g>=e?-1:g);return -1===h?void 0:a[h]}function j(a){return a!=a||0===a?0:Math.trunc(a)}(class a extends Map{#a;constructor(a){super(a),this.#a=[...super.keys()],h.set(this,!0)}set(a,b){return h.get(this)&&(this.has(a)?this.#a[this.#a.indexOf(a)]=a:this.#a.push(a)),super.set(a,b),this}insert(a,b,c){let d,e=this.has(b),f=this.#a.length,g=j(a),h=g>=0?g:f+g,i=h<0||h>=f?-1:h;if(i===this.size||e&&i===this.size-1||-1===i)return this.set(b,c),this;let k=this.size+ +!e;g<0&&h++;let l=[...this.#a],m=!1;for(let a=h;a<k;a++)if(h===a){let f=l[a];l[a]===b&&(f=l[a+1]),e&&this.delete(b),d=this.get(f),this.set(b,c)}else{m||l[a-1]!==b||(m=!0);let c=l[m?a:a-1],e=d;d=this.get(c),this.delete(c),this.set(c,e)}return this}with(b,c,d){let e=new a(this);return e.insert(b,c,d),e}before(a){let b=this.#a.indexOf(a)-1;if(!(b<0))return this.entryAt(b)}setBefore(a,b,c){let d=this.#a.indexOf(a);return -1===d?this:this.insert(d,b,c)}after(a){let b=this.#a.indexOf(a);if(-1!==(b=-1===b||b===this.size-1?-1:b+1))return this.entryAt(b)}setAfter(a,b,c){let d=this.#a.indexOf(a);return -1===d?this:this.insert(d+1,b,c)}first(){return this.entryAt(0)}last(){return this.entryAt(-1)}clear(){return this.#a=[],super.clear()}delete(a){let b=super.delete(a);return b&&this.#a.splice(this.#a.indexOf(a),1),b}deleteAt(a){let b=this.keyAt(a);return void 0!==b&&this.delete(b)}at(a){let b=i(this.#a,a);if(void 0!==b)return this.get(b)}entryAt(a){let b=i(this.#a,a);if(void 0!==b)return[b,this.get(b)]}indexOf(a){return this.#a.indexOf(a)}keyAt(a){return i(this.#a,a)}from(a,b){let c=this.indexOf(a);if(-1===c)return;let d=c+b;return d<0&&(d=0),d>=this.size&&(d=this.size-1),this.at(d)}keyFrom(a,b){let c=this.indexOf(a);if(-1===c)return;let d=c+b;return d<0&&(d=0),d>=this.size&&(d=this.size-1),this.keyAt(d)}find(a,b){let c=0;for(let d of this){if(Reflect.apply(a,b,[d,c,this]))return d;c++}}findIndex(a,b){let c=0;for(let d of this){if(Reflect.apply(a,b,[d,c,this]))return c;c++}return -1}filter(b,c){let d=[],e=0;for(let a of this)Reflect.apply(b,c,[a,e,this])&&d.push(a),e++;return new a(d)}map(b,c){let d=[],e=0;for(let a of this)d.push([a[0],Reflect.apply(b,c,[a,e,this])]),e++;return new a(d)}reduce(...a){let[b,c]=a,d=0,e=c??this.at(0);for(let c of this)e=0===d&&1===a.length?c:Reflect.apply(b,this,[e,c,d,this]),d++;return e}reduceRight(...a){let[b,c]=a,d=c??this.at(-1);for(let c=this.size-1;c>=0;c--){let e=this.at(c);d=c===this.size-1&&1===a.length?e:Reflect.apply(b,this,[d,e,c,this])}return d}toSorted(b){return new a([...this.entries()].sort(b))}toReversed(){let b=new a;for(let a=this.size-1;a>=0;a--){let c=this.keyAt(a),d=this.get(c);b.set(c,d)}return b}toSpliced(...b){let c=[...this.entries()];return c.splice(...b),new a(c)}slice(b,c){let d=new a,e=this.size-1;if(void 0===b)return d;b<0&&(b+=this.size),void 0!==c&&c>0&&(e=c-1);for(let a=b;a<=e;a++){let b=this.keyAt(a),c=this.get(b);d.set(b,c)}return d}every(a,b){let c=0;for(let d of this){if(!Reflect.apply(a,b,[d,c,this]))return!1;c++}return!0}some(a,b){let c=0;for(let d of this){if(Reflect.apply(a,b,[d,c,this]))return!0;c++}return!1}}),a.s(["createCollection",()=>g],28728);var k=b.createContext(void 0);function l(a){let c=b.useContext(k);return a||c||"ltr"}a.s(["useDirection",()=>l],30635)},49849,a=>{"use strict";let b=(0,a.i(72873).default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);a.s(["ChevronUp",()=>b],49849)},92010,a=>{"use strict";var b=a.i(92989),c=a.i(69198);function d(a){let[d,e]=b.useState(void 0);return(0,c.useLayoutEffect)(()=>{if(a){e({width:a.offsetWidth,height:a.offsetHeight});let b=new ResizeObserver(b=>{let c,d;if(!Array.isArray(b)||!b.length)return;let f=b[0];if("borderBoxSize"in f){let a=f.borderBoxSize,b=Array.isArray(a)?a[0]:a;c=b.inlineSize,d=b.blockSize}else c=a.offsetWidth,d=a.offsetHeight;e({width:c,height:d})});return b.observe(a,{box:"border-box"}),()=>b.unobserve(a)}e(void 0)},[a]),d}a.s(["useSize",()=>d])},37920,a=>{"use strict";var b=a.i(92989);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},25246,a=>{"use strict";let b=(0,a.i(72873).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);a.s(["ChevronRight",()=>b],25246)},45247,a=>{"use strict";let b=(0,a.i(72873).default)("circle-user",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);a.s(["UserCircle",()=>b],45247)},89971,28536,a=>{"use strict";var b=a.i(51959);let c=(0,b.createServerReference)("4026c9fd8c6a0c2a149b046d98dce7640094e3e759",b.callServer,void 0,b.findSourceMapURL,"createAppointment");a.s(["createAppointment",()=>c],89971);let d=(0,b.createServerReference)("60a4f4ade2852b49b8a0f9a20d20162d506a525fba",b.callServer,void 0,b.findSourceMapURL,"updateAppointment");a.s(["updateAppointment",()=>d],28536)},36229,a=>{"use strict";let b=(0,a.i(72873).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["CheckCircle2",()=>b],36229)},61224,a=>{"use strict";var b=a.i(50586),c=a.i(92989),d=a.i(43578),e=a.i(41487),f=a.i(61644),g=a.i(88524),h=a.i(89971),i=a.i(28536),j=a.i(63449),k=a.i(21798),l=a.i(10668),m=a.i(36229);let n=[{value:"scheduled",label:"Geplant"},{value:"confirmed",label:"Bestätigt"},{value:"completed",label:"Abgeschlossen"},{value:"cancelled",label:"Abgesagt"},{value:"no_show",label:"Nicht erschienen"}],o={0:"sunday",1:"monday",2:"tuesday",3:"wednesday",4:"thursday",5:"friday",6:"saturday"};function p({open:a,onOpenChange:p,appointment:q,customers:r,services:s,employees:t,existingAppointments:u=[]}){let v=(0,j.useRouter)(),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(null),A=!!q,[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)("scheduled"),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)([]);async function R(a){a.preventDefault(),x(!0),z(null);let b=new FormData;b.set("customer_id",B),b.set("service_id",D),b.set("employee_id",F),b.set("appointment_date",H),b.set("appointment_time",J),b.set("status",L),b.set("customer_notes",N);let c=A?await (0,i.updateAppointment)(q.id,b):await (0,h.createAppointment)(b);c.error?(z(c.error),x(!1)):(x(!1),p(!1),v.refresh())}(0,c.useEffect)(()=>{a&&(q?(C(q.customer_id),E(q.service_id),G(q.employee_id||""),I(new Date(q.start_time).toISOString().split("T")[0]),K(new Date(q.start_time).toTimeString().slice(0,5)),M(q.status),O(q.customer_notes||"")):(C(""),E(""),G(""),I(""),K(""),M("scheduled"),O("")),z(null))},[a,q]),(0,c.useEffect)(()=>{if(!H||!D)return void Q([]);let a=s.find(a=>a.id===D);if(!a)return void Q([]);let b=a.duration_minutes,c=o[new Date(H).getDay()],d="09:00",e="18:00";if(F){let a=t.find(a=>a.id===F);if(a?.work_schedule?.[c])d=a.work_schedule[c].start,e=a.work_schedule[c].end;else if(a?.work_schedule&&Object.keys(a.work_schedule).length>0)return void Q([])}let f=[],[g,h]=d.split(":").map(Number),[i,j]=e.split(":").map(Number),k=60*g+h,l=60*i+j;for(let a=k;a+b<=l;a+=30){let c=Math.floor(a/60),d=a%60,e=`${c.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`,g=new Date(`${H}T${e}`),h=new Date(g.getTime()+6e4*b);u.some(a=>{if("cancelled"===a.status||q&&a.id===q.id||F&&a.employee_id!==F)return!1;let b=new Date(a.start_time);return g<new Date(a.end_time)&&h>b})||f.push(e)}Q(f)},[H,F,D,s,t,u,q]);let S=s.find(a=>a.id===D);return(0,b.jsx)(d.Dialog,{open:a,onOpenChange:p,children:(0,b.jsxs)(d.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(d.DialogHeader,{children:[(0,b.jsx)(d.DialogTitle,{children:A?"Termin bearbeiten":"Neuer Termin"}),(0,b.jsx)(d.DialogDescription,{children:A?"Aktualisiere die Termin-Details":"Erstelle einen neuen Termin"})]}),(0,b.jsxs)("form",{onSubmit:R,className:"space-y-4",children:[y&&(0,b.jsxs)("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-md flex items-start gap-2",children:[(0,b.jsx)(l.AlertCircle,{className:"w-5 h-5 text-destructive flex-shrink-0 mt-0.5"}),(0,b.jsx)("p",{className:"text-sm text-destructive",children:y})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"customer_id",children:"Kunde *"}),(0,b.jsxs)("select",{id:"customer_id",value:B,onChange:a=>C(a.target.value),required:!0,disabled:w,className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:[(0,b.jsx)("option",{value:"",children:"Kunde auswählen"}),r.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.first_name," ",a.last_name]},a.id))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"service_id",children:"Behandlung *"}),(0,b.jsxs)("select",{id:"service_id",value:D,onChange:a=>E(a.target.value),required:!0,disabled:w,className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:[(0,b.jsx)("option",{value:"",children:"Behandlung auswählen"}),s.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (",a.duration_minutes," Min)"]},a.id))]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"employee_id",children:"Mitarbeiter"}),(0,b.jsxs)("select",{id:"employee_id",value:F,onChange:a=>{G(a.target.value),K("")},disabled:w,className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:[(0,b.jsx)("option",{value:"",children:"Kein Mitarbeiter zugewiesen"}),t.filter(a=>a.is_active).map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.first_name," ",a.last_name," (",a.role,")"]},a.id))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"appointment_date",children:"Datum *"}),(0,b.jsx)(f.Input,{id:"appointment_date",type:"date",value:H,onChange:a=>{I(a.target.value),K("")},required:!0,disabled:w})]}),H&&D&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Clock,{className:"w-4 h-4"}),"Uhrzeit wählen *",S&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",S.duration_minutes," Min pro Termin)"]})]}),P.length>0?(0,b.jsx)("div",{className:"flex flex-wrap gap-2 p-3 bg-muted/30 rounded-lg max-h-40 overflow-y-auto",children:P.map(a=>(0,b.jsxs)(e.Button,{type:"button",variant:J===a?"default":"outline",size:"sm",onClick:()=>K(a),className:"text-xs",disabled:w,children:[a,J===a&&(0,b.jsx)(m.CheckCircle2,{className:"w-3 h-3 ml-1"})]},a))}):(0,b.jsx)("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-md text-sm text-orange-800",children:F?"Keine verfügbaren Zeiten für diesen Mitarbeiter an diesem Tag.":"Bitte wähle zuerst einen Mitarbeiter, um verfügbare Zeiten zu sehen."}),J&&(0,b.jsxs)("div",{className:"text-sm text-green-600 flex items-center gap-1",children:[(0,b.jsx)(m.CheckCircle2,{className:"w-4 h-4"}),"Gewählte Zeit: ",(0,b.jsxs)("strong",{children:[J," Uhr"]})]}),(0,b.jsx)("input",{type:"hidden",name:"appointment_time",value:J,required:!0})]}),!H&&D&&(0,b.jsx)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-800",children:"Bitte wähle ein Datum, um verfügbare Zeiten zu sehen."}),!D&&(0,b.jsx)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-800",children:"Bitte wähle eine Behandlung, um verfügbare Zeiten zu sehen."}),A&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"status",children:"Status *"}),(0,b.jsx)("select",{id:"status",value:L,onChange:a=>M(a.target.value),required:!0,disabled:w,className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:n.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"customer_notes",children:"Notizen"}),(0,b.jsx)("textarea",{id:"customer_notes",placeholder:"Besondere Wünsche, Hinweise...",value:N,onChange:a=>O(a.target.value),disabled:w,rows:3,className:"flex w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,b.jsxs)(d.DialogFooter,{children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>p(!1),disabled:w,children:"Abbrechen"}),(0,b.jsx)(e.Button,{type:"submit",disabled:w,children:w?"Wird gespeichert...":A?"Speichern":"Erstellen"})]})]})]})})}a.s(["AppointmentDialog",()=>p])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__72c61a08._.js.map