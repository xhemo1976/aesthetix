{"version":3,"sources":["../../../../../../apps/web/lib/actions/settings.ts","../../../../../../apps/web/.next-internal/server/app/dashboard/settings/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["'use server'\n\nimport { revalidatePath } from 'next/cache'\nimport { createClient } from '@/lib/supabase/server'\nimport { createAdminClient } from '@/lib/supabase/admin'\n\nexport async function getTenantSettings() {\n  const supabase = await createClient()\n  const adminClient = createAdminClient()\n\n  // Get current user\n  const { data: { user } } = await supabase.auth.getUser()\n  if (!user) {\n    return { settings: null, error: 'Nicht authentifiziert' }\n  }\n\n  // Get tenant_id\n  const { data: profile } = await adminClient\n    .from('users')\n    .select('tenant_id')\n    .eq('id', user.id)\n    .single() as { data: { tenant_id: string } | null }\n\n  if (!profile) {\n    return { settings: null, error: 'Profil nicht gefunden' }\n  }\n\n  // Get tenant settings\n  const { data: tenant, error } = await supabase\n    .from('tenants')\n    .select('*')\n    .eq('id', profile.tenant_id)\n    .single()\n\n  if (error) {\n    console.error('Error fetching tenant:', error)\n    return { settings: null, error: error.message }\n  }\n\n  return { settings: tenant, error: null }\n}\n\nexport async function updateTenantSettings(formData: FormData) {\n  const supabase = await createClient()\n  const adminClient = createAdminClient()\n\n  // Get current user\n  const { data: { user } } = await supabase.auth.getUser()\n  if (!user) {\n    return { error: 'Nicht authentifiziert' }\n  }\n\n  // Get tenant_id\n  const { data: profile } = await adminClient\n    .from('users')\n    .select('tenant_id')\n    .eq('id', user.id)\n    .single() as { data: { tenant_id: string } | null }\n\n  if (!profile) {\n    return { error: 'Profil nicht gefunden' }\n  }\n\n  const name = formData.get('name') as string\n  const contact_phone = formData.get('contact_phone') as string\n  const contact_email = formData.get('contact_email') as string\n  const whatsapp_number = formData.get('whatsapp_number') as string\n  const address = formData.get('address') as string\n  const city = formData.get('city') as string\n  const postal_code = formData.get('postal_code') as string\n\n  const { error } = await supabase\n    .from('tenants')\n    .update({\n      name,\n      contact_phone: contact_phone || null,\n      contact_email: contact_email || null,\n      whatsapp_number: whatsapp_number || null,\n      address: address || null,\n      city: city || null,\n      postal_code: postal_code || null,\n    })\n    .eq('id', profile.tenant_id)\n\n  if (error) {\n    console.error('Error updating tenant:', error)\n    return { error: error.message }\n  }\n\n  revalidatePath('/dashboard/settings')\n  revalidatePath('/dashboard')\n  return { error: null }\n}\n","export {logout as '00ea5d6db9aa78d155ad7148c00d987a78197cad0e'} from 'ACTIONS_MODULE0'\nexport {login as '40557600bffd5a2c9eccc9fb8b66b41ea0de68fa87'} from 'ACTIONS_MODULE0'\nexport {signup as '40edf544285d63aedbf98dd3fd472b99b616040b0a'} from 'ACTIONS_MODULE0'\nexport {getTenantSettings as '000394212ee760024230aaabf0277c0143a4959c7b'} from 'ACTIONS_MODULE1'\nexport {updateTenantSettings as '408713dad5b69ddff4146ae0627d12db9f67ec8232'} from 'ACTIONS_MODULE1'\nexport {updateTenantSettings as '408713dad5b69ddff4146ae0627d12db9f67ec8232'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEO,eAAe,IACpB,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAC7B,EAAc,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAG/B,CAAE,KAAM,MAAE,CAAI,CAAE,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,OAAO,GACtD,GAAI,CAAC,EACH,IADS,EACF,CAAE,SAAU,KAAM,MAAO,uBAAwB,EAI1D,GAAM,CAAE,KAAM,CAAO,CAAE,CAAG,MAAM,EAC7B,IAAI,CAAC,SACL,MAAM,CAAC,aACP,EAAE,CAAC,KAAM,EAAK,EAAE,EAChB,MAAM,GAET,GAAI,CAAC,EACH,MAAO,CAAE,AADG,SACO,KAAM,MAAO,uBAAwB,EAI1D,GAAM,CAAE,KAAM,CAAM,OAAE,CAAK,CAAE,CAAG,MAAM,EACnC,IAAI,CAAC,WACL,MAAM,CAAC,KACP,EAAE,CAAC,KAAM,EAAQ,SAAS,EAC1B,MAAM,UAET,AAAI,GACF,IADS,IACD,KAAK,CAAC,yBAA0B,GACjC,CAAE,SAAU,KAAM,MAAO,EAAM,OAAO,AAAC,GAGzC,CAAE,SAAU,EAAQ,MAAO,IAAK,CACzC,CAEO,eAAe,EAAqB,CAAkB,EAC3D,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAC7B,EAAc,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAG/B,CAAE,KAAM,MAAE,CAAI,CAAE,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,OAAO,GACtD,GAAI,CAAC,EACH,IADS,EACF,CAAE,MAAO,uBAAwB,EAI1C,GAAM,CAAE,KAAM,CAAO,CAAE,CAAG,MAAM,EAC7B,IAAI,CAAC,SACL,MAAM,CAAC,aACP,EAAE,CAAC,KAAM,EAAK,EAAE,EAChB,MAAM,GAET,GAAI,CAAC,EACH,MAAO,CADK,AACH,MAAO,uBAAwB,EAG1C,IAAM,EAAO,EAAS,GAAG,CAAC,QACpB,EAAgB,EAAS,GAAG,CAAC,iBAC7B,EAAgB,EAAS,GAAG,CAAC,iBAC7B,EAAkB,EAAS,GAAG,CAAC,mBAC/B,EAAU,EAAS,GAAG,CAAC,WACvB,EAAO,EAAS,GAAG,CAAC,QACpB,EAAc,EAAS,GAAG,CAAC,eAE3B,OAAE,CAAK,CAAE,CAAG,MAAM,EACrB,IAAI,CAAC,WACL,MAAM,CAAC,MACN,EACA,cAAe,GAAiB,KAChC,cAAe,GAAiB,KAChC,gBAAiB,GAAmB,KACpC,QAAS,GAAW,KACpB,KAAM,GAAQ,KACd,YAAa,GAAe,IAC9B,GACC,EAAE,CAAC,KAAM,EAAQ,SAAS,SAE7B,AAAI,GACF,IADS,IACD,KAAK,CAAC,yBAA0B,GACjC,CAAE,MAAO,EAAM,OAAO,AAAC,IAGhC,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,uBACf,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,cACR,CAAE,MAAO,IAAK,EACvB,0CAtFsB,EAoCA,IApCA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAoCA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,4FC1CtB,IAAA,EAAA,EAAA,CAAA,CAAA,OAGA,EAAA,EAAA,CAAA,CAAA"}